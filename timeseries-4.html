<!DOCTYPE html>
<html lang="fr">

<head>
<title>Les séries temporelles avec Python (4/4) - Analyse et modélisation</title>    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="Le blog statistiques et data science de la coopérative Statoscop" />
  <meta name="author" content="" />

  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />



  <!-- <title>Le blog de Statoscop - études de cas en R et Python</title> -->
  <link rel="icon" type="image/x-icon" href="https://blog.statoscop.fr/themes/statoscop/static/images/favicon-v1.ico" />


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://blog.statoscop.fr/timeseries-4.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://blog.statoscop.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Full Atom Feed" />
          <link href="https://blog.statoscop.fr/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Categories Atom Feed" />

  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style.css" type="text/css" rel="stylesheet" />-->
  <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style-site.css" type="text/css" rel="stylesheet" /> 
  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style_fusion.css" type="text/css" rel="stylesheet" /> -->
  <!-- Code highlight color scheme -->
      <link href="https://blog.statoscop.fr/themes/statoscop/static/css/code_blocks/github.css" rel="stylesheet">

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!-- [if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  ![endif] -->



    <meta name="description" content="Analyse d'une série temporelle par décomposition et modélisations classiques.">

    <meta name="author" content="Louis">

    <meta name="tags" content="Python">
    <meta name="tags" content="Machine Learning">
    <meta name="tags" content="Statistiques">
    <meta name="tags" content="Data Science">
    <meta name="tags" content="Séries temporelles">
    <meta name="tags" content="Datetime">
    <meta name="tags" content="ARMA">
    <meta name="tags" content="SARIMA">
    <meta name="tags" content="Time Series">




<!-- Open Graph -->
<meta property="og:site_name" content="Le blog"/>
<meta property="og:title" content="Les séries temporelles avec Python (4/4) - Analyse et modélisation"/>
<meta property="og:description" content="Analyse d'une série temporelle par décomposition et modélisations classiques."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://blog.statoscop.fr/timeseries-4.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2022-11-14 00:00:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://blog.statoscop.fr/author/louis.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="Python"/>
<meta property="article:tag" content="Machine Learning"/>
<meta property="article:tag" content="Statistiques"/>
<meta property="article:tag" content="Data Science"/>
<meta property="article:tag" content="Séries temporelles"/>
<meta property="article:tag" content="Datetime"/>
<meta property="article:tag" content="ARMA"/>
<meta property="article:tag" content="SARIMA"/>
<meta property="article:tag" content="Time Series"/>
<meta property="og:image" content="https://blog.statoscop.fr/images/cover_13.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Les séries temporelles avec Python (4/4) - Analyse et modélisation",
  "headline": "Les séries temporelles avec Python (4/4) - Analyse et modélisation",
  "datePublished": "2022-11-14 00:00:00+01:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Louis",
    "url": "https://blog.statoscop.fr/author/louis.html"
  },
  "image": "https://blog.statoscop.fr/images/cover_13.png",
  "url": "https://blog.statoscop.fr/timeseries-4.html",
  "description": "Analyse d'une série temporelle par décomposition et modélisations classiques."
}
</script>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//matomo.statoscop.fr/matomo/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  

</head>
<!-- TODO : Body class -->
  <body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">

        <a class="navbar-brand" href="https://statoscop.fr"><img src="https://blog.statoscop.fr/themes/statoscop/static/images/logo-statoscop-v1.png" alt="Statoscop.logo"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr"> Accueil </a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/about"> À propos </a>
              </li>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle font-weight-bold "
                  id="navbarDropdownMenuLink" aria-haspopup="true" aria-expanded="false"> Prestations </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      <li><a class="dropdown-item" href="https://statoscop.fr/etudes">Conseils & études statistiques</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/recodages">Migrations de code & Recodages</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/formations">Formations</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/applis">Dashboards & Applications</a></li>
                  </ul>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/contact">Contact</a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger active" href="https://blog.statoscop.fr/">Le blog</a>
              </li>
          </ul>
      </div>
      </div>
    </nav>
    


    <!-- Post content -->
    <main class="content" role="main">
      
      <div>
      </div>

      <article class="post">
        <div class="inner">




            <section class="post-content">
              <h1 class="post-title">Les séries temporelles avec Python (4/4) - Analyse et modélisation</h1>
                <!-- Le titres et meta infos-->
                <span class="post-meta">
                        <a href="https://blog.statoscop.fr/author/louis.html">Louis</a>
                    | <time datetime="lun. 14 novembre 2022">lun. 14 novembre 2022</time>
                </span>

                <!--Table des matieres
-->
                
                <div class="toc"><span class="toctitle">Table des matières</span><ul>
<li><a href="#decomposition-dune-serie-temporelle">Décomposition d'une série temporelle</a><ul>
<li><a href="#la-tendance">La tendance</a></li>
<li><a href="#la-saisonnalite">La saisonnalité</a></li>
<li><a href="#le-bruit">Le bruit</a></li>
</ul>
</li>
<li><a href="#prevision-avec-un-lissage-exponentiel">Prévision avec un lissage exponentiel</a></li>
<li><a href="#prevision-a-laide-dun-modele-arima">Prévision à l'aide d'un modèle ARIMA</a><ul>
<li><a href="#stationnarisation-de-la-serie">Stationnarisation de la série</a></li>
<li><a href="#identification-estimation-et-validation-de-modeles">Identification, estimation et validation de modèles</a></li>
<li><a href="#prevision-de-lannee-1961-avec-le-modele-retenu">Prévision de l’année 1961 avec le modèle retenu</a></li>
<li><a href="#evaluation-de-la-qualite-predictive-du-modele">Évaluation de la qualité prédictive du modèle</a></li>
<li><a href="#une-autre-approche-pour-la-determination-du-modele">Une autre approche pour la détermination du modèle</a></li>
</ul>
</li>
<li><a href="#pour-aller-plus-loin">Pour aller plus loin</a></li>
</ul>
</div>
<blockquote>
<ol>
<li>Introduction à la manipulation de données temporelles avec Python</li>
<li>Visualisation et opérations sur les séries temporelles</li>
<li>Éléments théoriques et exemples</li>
<li><strong>Analyse, modélisation et prédiction</strong></li>
</ol>
</blockquote>
<p>Après une toute petite ellipse temporelle de plus d'un an, ce quatrième post s'attaque au vrai problème à savoir la décomposition, la modélisation et la prédiction des séries temporelles à l'aide des modèles statistiques classiques.</p>
<h1 id="decomposition-dune-serie-temporelle">Décomposition d'une série temporelle</h1>
<p>Le principe de la décomposition des séries temporelles est de découper les séries originales en plusieurs composants indépendants (vus dans le post précédent) : tendance, saisonnalité, cycle et bruit.</p>
<p>Pour illustrer tout ça, on va utiliser des données qui sont aux séries temporelles ce que le dataset "Titanic" est au machine learning : la série AirPassenger qui mesure le nombre mensuel de passagers aériens, en milliers, de janvier 1949 à décembre 1960. Dans la suite, on notera <span class="math">\(X_{t}\)</span>  la série AirPassengers et <span class="math">\(Y_t=ln(X_t)\)</span>. </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">fonctions</span> <span class="k">as</span> <span class="nn">fct</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/AirPassengers.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># création d&#39;un graphique avec la série originale</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ln1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;nb passagers&quot;</span><span class="p">)</span>

<span class="c1"># création d&#39;un graphique avec la série log en conservent le même axe des abscisses</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ln2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;log(nb passagers)&quot;</span><span class="p">)</span>

<span class="c1"># ajout de la légende</span>
<span class="n">lns</span> <span class="o">=</span> <span class="n">ln1</span> <span class="o">+</span> <span class="n">ln2</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lns</span><span class="p">,</span> <span class="n">labels</span><span class="p">);</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_4_0.png"></p>
<p>On voit sur la série initiale (en rouge) que l'amplitude des variations augmente chaque année de manière exponentielle. Or dans un cadre théorique parfait, on voudrait une variance constante au court du temps. Pour s'en approcher on peut passer par la fonction logarithme. En effet, comme <span class="math">\(log(ab) = log(a) + log(b)\)</span>, le <span class="math">\(log\)</span> transforme un modèle <strong>multiplicatif</strong> en un modèle <strong>additif</strong>. Ainsi l'accroissement de l'amplitude des pics (donc de la variance) pour la série <span class="math">\(X\)</span> disparaît avec la transformation logarithmique. C'est visible sur la courbe bleue.  </p>
<h2 id="la-tendance">La tendance</h2>
<p>On a présenté dans le premier post une façon de visualiser la tendance en lissant la courbe à l'aide des moyennes mobiles sur une fenêtre glissante d'observations. Lorsqu'on choisit différentes tailles de fenêtres glissantes, on obtient les résultats suivants.</p>
<div class="highlight"><pre><span></span><code><span class="n">win</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">36</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">win</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">win</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;moyenne sur </span><span class="si">{</span><span class="n">win</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> mois&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_6_0.png"></p>
<p>En prenant une fenêtre de 12, 24 ou 36 mois, une tendance linéaire et croissante est bien visible. Par ailleurs, le fait que cette tendance est identifiable pour des fenêtres glissantes dont la taille est un multiple de 12 mois suggère une notion de saisonnalité. On ne sait peut-être pas encore ce que c'est, mais en tout cas, il se passe quelque chose tous les 12 mois...</p>
<h2 id="la-saisonnalite">La saisonnalité</h2>
<p>La saisonnalité désigne les tendances hebdomadaires, mensuelles, trimestrielles ou annuelles. Ce sont les motifs qui se répètent sur une durée infra-annuelle. Il semble qu'on ait ici une saisonnalité annuelle. Une manière visuelle de vérifier l'effet saisonnier est de tracer une courbe pour chaque année en prenant les mois comme abscisses et visualiser ainsi la répartition des passagers au cours de chaque année.</p>
<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">yrs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span> <span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
<span class="n">mths</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month_name</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">yrs</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yrs</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mths</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">yrs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="n">yrs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_8_0.png"></p>
<p>Ça confirme bien l'intuition : les variations du nombre de passagers aériens sur une année sont similaires d'une année sur l'autre. C'est la saisonnalité. Et en plus c'est joli.</p>
<h2 id="le-bruit">Le bruit</h2>
<p>Il ne reste plus qu'à identifier ce qu'il reste : le bruit. On l'obtient donc en soustrayant (dans un modèle additif !) à la série originale les tendance et saisonnalité. Au final, voilà une série décomposée.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span><span class="p">,</span> <span class="n">STL</span>

<span class="n">decomp</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">decomp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_10_0.png"></p>
<blockquote>
<p>👋 Nous c'est Antoine et Louis de Statoscop, une coopérative de statisticiens / data scientists.
Vous voulez en savoir plus sur ce que l'on fait?</p>
</blockquote>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br></p>
<h1 id="prevision-avec-un-lissage-exponentiel">Prévision avec un lissage exponentiel</h1>
<p>Le lissage exponentiel est une technique de lissage pas brésilien qui ressemble un peu aux moyennes mobiles. Cette méthode peut être utilisée pour prédire une série temporelle. C'est en fait un cas particulier des modèles ARMA déjà évoqués. On en distingue différents types (simple, double, triple...). On notera que les lissages exponentiels simple et double ne sont plus vraiment d'actualité donc on présente seulement le lissage exponentiel triple qui, lui, est parfois utilisé.</p>
<p>Le lissage exponentiel triple ou méthode de Holt-Winters est adapté à des séries à tendance localement linéaire avec en plus une composante saisonnière. Ce qui est le cas de notre série logarithmique.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>

<span class="n">let</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">let</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span><span class="c1"># prédiction pour la série log</span>
<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">let</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span> <span class="c1"># récupération des prédiction pour la série originale</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;log(Airpass)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pred&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Airpass&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pred&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_12_0.png"></p>
<h1 id="prevision-a-laide-dun-modele-arima">Prévision à l'aide d'un modèle ARIMA</h1>
<p>Un modèle autoréfressif intégré à moyennes mobiles (ARIMA) est une généralisation du modèle ARMA, aperçu dans le post précédent. Ils sont utilisés dans certains cas où les données montrent une non-stationnarité. Une étape de différenciation initiale (correspondant à la partie "intégrée" du modèle) peut alors être appliquée une ou plusieurs fois afin d'éliminer la non-stationnarité. Dans le modèle de base, trois paramètres <span class="math">\((p,d,q)\)</span> sont utilisés pour caractériser les modèles ARIMA. On les note donc <span class="math">\(ARIMA(p,d,q)\)</span> et ils sont définis par :
</p>
<div class="math">$$
\left(1 - \sum_{i=1}^p \phi_i L^i \right) (1 - L)^d y_t = \mu + \left(1 + \sum_{i=1}^q \theta_i L^i \right) \varepsilon_t
$$</div>
<p><span class="math">\(L\)</span> est l'opérateur <em>retard</em> qui consiste à décaler la série d'une observation.</p>
<p>SARIMA, ou ARIMA saisonnier, est une généralisation du modèle ARIMA qui permet de tenir compte de la saisonnalité. Ce modèle est caractérisé non plus par 3 paramètres <span class="math">\((p,d,q)\)</span> mais par 7 ! Il est noté <span class="math">\(SARIMA(p,d,q)(P,D,Q)_s\)</span> où :
- <span class="math">\(s\)</span> est la période de la saisonnalité
- <span class="math">\((P,D,Q)\)</span> sont les ordres de la partie saisonnière</p>
<h2 id="stationnarisation-de-la-serie">Stationnarisation de la série</h2>
<p>Les séries ont généralement une tendance et une saisonnalité toutefois afin de pouvoir les modéliser par des processus stationnaires comme les ARMA, il faut qu'elles soient stationnaires. Or elles ne le sont que rarement, il faut donc les stationnariser.</p>
<p>On sait que notre série n'est pas stationnaire (c'est vérifiable en regardant l'autocorrélogramme qui doit présenter une décroissance lente vers 0). Par ailleurs, on a déjà identifié la saisonnalité de nos observations qui est annuelle. On peut déjà effectuer une différenciation en appliquant l'opérateur <span class="math">\((1-L^{12})\)</span> .</p>
<div class="highlight"><pre><span></span><code><span class="n">y_diff_12</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plot_acf_pacf</span><span class="p">(</span><span class="n">y_diff_12</span><span class="p">[</span><span class="mi">12</span><span class="p">:],</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_14_0.png"></p>
<p>La sortie ACF présente bien une décroissance lente vers 0, ce qui traduit la non-stationnarité. On effectue donc une différenciation en appliquant cette fois l'opérateur <span class="math">\((1-L)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="n">y_diff_12_1</span> <span class="o">=</span> <span class="n">y_diff_12</span> <span class="o">-</span> <span class="n">y_diff_12</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plot_acf_pacf</span><span class="p">(</span><span class="n">y_diff_12_1</span><span class="p">[</span><span class="mi">13</span><span class="p">:],</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_16_0.png"></p>
<p>Avec cette double différenciation, on s'approche d'un autocorrélogramme simple empirique. On va donc modéliser la série <span class="math">\((1-L)(1-L^{12})ln(X_t)\)</span> par un modèle ARMA.</p>
<h2 id="identification-estimation-et-validation-de-modeles">Identification, estimation et validation de modèles</h2>
<p>On va s'appuyer sur les sorties ACF et PACF donc on peut utiliser une des fonctions disponibles dans <code>fonctions.py</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">y_diff_12_1</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span><span class="o">.</span><span class="n">Airpass</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_19_0.png"></p>
<p>Les graphiques ACF et PACF permettent de voir empiriquement qu'on va avoir un modèle <span class="math">\(SARIMA(p,d,q)(P,D,Q)_s\)</span> avec <span class="math">\(s=12\)</span>.</p>
<p>Il est possible de trouver empiriquement un ordre de grandeur maximum pour les parties <em>autorégressive</em> et <em>moyenne mobile</em>, c'est-à-dire pour les valeurs <span class="math">\(p_{max}\)</span> et <span class="math">\(q_{max}\)</span> d'un modèle <span class="math">\(ARMA(p,q)\)</span>. La détermination de bornes supérieures concernant l'ordre de la partie <span class="math">\(AR\)</span> et de la partie <span class="math">\(MA\)</span> passe par l'étude des autocorrélogrammes et des autocorrélogrammes partiels. En effet, si la série stationnaire suit un modèle <span class="math">\(ARMA(p,q)\)</span> alors :  </p>
<ul>
<li>l'autocorrélogramme ACF devient nul à partir du rang <span class="math">\(q+1\)</span>  </li>
<li>l'autocorrélogramme partiel PACF devient nul à partir du rang <span class="math">\(p+1\)</span></li>
</ul>
<p>Le tableau suivant résume les propriétés des tracés de l'ACF et de la PACF empiriques :</p>
<table>
<thead>
<tr>
<th></th>
<th align="center">MA(q)</th>
<th align="center">AR(p)</th>
<th align="center">ARMA(p,q)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACF</td>
<td align="center">0 si k &gt; q</td>
<td align="center"><span class="math">\(\searrow\)</span></td>
<td align="center"><span class="math">\(\searrow\)</span></td>
</tr>
<tr>
<td>PACF</td>
<td align="center"><span class="math">\(\searrow\)</span></td>
<td align="center">0 si k &gt; p</td>
<td align="center"><span class="math">\(\searrow\)</span></td>
</tr>
</tbody>
</table>
<p>Dès lors, en se basant sur les autocorrélogrammes, il est possible de déterminer empiriquement les ordres maximum en regardant à partir de quel rang les autocorrélogrammes sont statistiquement nuls. Dans notre cas, on peut considérer que <span class="math">\(p_{max} = q_{max} = 1\)</span> et on va donc tester différents modèles compte tenu de ces bornes.</p>
<p><strong>Modèle 1 :</strong> pour commencer on modélise un <span class="math">\(SARIMA(1,1,1)(1,1,1)_{12}\)</span> qui s'écrit :
</p>
<div class="math">$$(1-\phi_{1}L)(1-\phi'_{1}L^{12})(1-L)(1-L^{12})ln(X_{t})=(1+\theta_{1}L)(1+\theta'_{1}L^{12})\epsilon_{t} $$</div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.sarimax</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">m1</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">res1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                     SARIMAX Results                                      
==========================================================================================
Dep. Variable:                                  y   No. Observations:                  144
Model:             SARIMAX(1, 1, 1)x(1, 1, 1, 12)   Log Likelihood                 245.152
Date:                            Wed, 09 Nov 2022   AIC                           -480.304
Time:                                    15:47:19   BIC                           -465.928
Sample:                                         0   HQIC                          -474.462
                                            - 144                                         
<span class="gh">Covariance Type:                              opg                                         </span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ar.L1          0.1701      0.212      0.801      0.423      -0.246       0.586
ma.L1         -0.5649      0.184     -3.074      0.002      -0.925      -0.205
ar.S.L12      -0.0997      0.197     -0.506      0.613      -0.486       0.286
ma.S.L12      -0.4967      0.210     -2.364      0.018      -0.909      -0.085
<span class="gh">sigma2         0.0013      0.000      8.458      0.000       0.001       0.002</span>
<span class="gh">===================================================================================</span>
Ljung-Box (L1) (Q):                   0.01   Jarque-Bera (JB):                 3.51
Prob(Q):                              0.91   Prob(JB):                         0.17
Heteroskedasticity (H):               0.61   Skew:                            -0.01
<span class="gh">Prob(H) (two-sided):                  0.11   Kurtosis:                         3.80</span>
<span class="gh">===================================================================================</span>

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</code></pre></div>

<p>Ce modèle a des coefficients non significatifs, on en teste un second en retirant dans le paramètre associé à la plus grande p-value : ici c'est le terme autorégressif saisonnier.</p>
<p><strong>Modèle 2 :</strong> on modélise donc un <span class="math">\(SARIMA(1,1,1)(0,1,1)_{12}\)</span> qui s'écrit :
</p>
<div class="math">$$(1-\phi_{1}L)(1-L)(1-L^{12})ln(X_{t})=(1+\theta_{1}L)(1+\theta'_{1}L^{12})\epsilon_{t} $$</div>
<div class="highlight"><pre><span></span><code><span class="n">m2</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                     SARIMAX Results                                      
==========================================================================================
Dep. Variable:                                  y   No. Observations:                  144
Model:             SARIMAX(1, 1, 1)x(0, 1, 1, 12)   Log Likelihood                 244.945
Date:                            Wed, 09 Nov 2022   AIC                           -481.890
Time:                                    15:47:21   BIC                           -470.389
Sample:                                         0   HQIC                          -477.217
                                            - 144                                         
<span class="gh">Covariance Type:                              opg                                         </span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ar.L1          0.1841      0.201      0.915      0.360      -0.210       0.578
ma.L1         -0.5667      0.174     -3.248      0.001      -0.909      -0.225
ma.S.L12      -0.5633      0.104     -5.417      0.000      -0.767      -0.359
<span class="gh">sigma2         0.0013      0.000      8.624      0.000       0.001       0.002</span>
<span class="gh">===================================================================================</span>
Ljung-Box (L1) (Q):                   0.02   Jarque-Bera (JB):                 3.35
Prob(Q):                              0.89   Prob(JB):                         0.19
Heteroskedasticity (H):               0.60   Skew:                            -0.00
<span class="gh">Prob(H) (two-sided):                  0.09   Kurtosis:                         3.78</span>
<span class="gh">===================================================================================</span>

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</code></pre></div>

<p>Ce modèle a toujours un coefficient non significatif, on en teste un 3ème modèle en retirant le terme autorégressif d'ordre 1.</p>
<p><strong>Modèle 3 :</strong> on modélise donc un <span class="math">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span> qui s'écrit :
</p>
<div class="math">$$(1-L)(1-L^{12})ln(X_{t})=(1+\theta_{1}L)(1+\theta'_{1}L^{12})\epsilon_{t} $$</div>
<div class="highlight"><pre><span></span><code><span class="n">m3</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">res3</span> <span class="o">=</span> <span class="n">m3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res3</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                     SARIMAX Results                                      
==========================================================================================
Dep. Variable:                                  y   No. Observations:                  144
Model:             SARIMAX(0, 1, 1)x(0, 1, 1, 12)   Log Likelihood                 244.696
Date:                            Wed, 09 Nov 2022   AIC                           -483.393
Time:                                    15:47:22   BIC                           -474.767
Sample:                                         0   HQIC                          -479.888
                                            - 144                                         
<span class="gh">Covariance Type:                              opg                                         </span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ma.L1         -0.4013      0.073     -5.496      0.000      -0.544      -0.258
ma.S.L12      -0.5566      0.096     -5.780      0.000      -0.745      -0.368
<span class="gh">sigma2         0.0013      0.000      9.121      0.000       0.001       0.002</span>
<span class="gh">===================================================================================</span>
Ljung-Box (L1) (Q):                   0.04   Jarque-Bera (JB):                 1.90
Prob(Q):                              0.85   Prob(JB):                         0.39
Heteroskedasticity (H):               0.58   Skew:                             0.02
<span class="gh">Prob(H) (two-sided):                  0.07   Kurtosis:                         3.59</span>
<span class="gh">===================================================================================</span>

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</code></pre></div>

<p>Cette fois tous les coefficients sont significatifs, il faut encore tester ce qu'on appelle la "blancheur" des résidus : on veut avoir des résidus qui sont un bruit blanc (faible), c'est-à-dire, entre autres qu'ils sont non corrélés.<br>
Pour ça on peut utiliser le test de Ljung-Box d'autocorrélation des résidus qui est implémenté dans la fonction <code>acorr_ljungbox</code> de <code>statsmodels.stats.diagnostic</code> </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Retard : p-value&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">36</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lag</span><span class="p">,</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">res3</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lag</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">Retard</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">-</span><span class="n">value</span>
<span class="mi">6</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.981720860200859</span>
<span class="mi">12</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.9083064612785483</span>
<span class="mi">18</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.6207396507474344</span>
<span class="mi">24</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.5187361239841579</span>
<span class="mi">30</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.5161804687133994</span>
<span class="mi">36</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.560395354197207</span>
</code></pre></div>

<p>Toutes les p-values sont élevées ce qui signifie qu'on ne peut pas rejeter l'hypothèse nulle du test. Or, l'hypothèse <span class="math">\(H_0\)</span> est qu'il n'y a pas d'autocorrélation des résidus, on peut pas la rejeter, donc on est bon !</p>
<p>On peut enfin tester la normalité des résidus avec le test de Shapiro-Wilk implémenté dans la fonction <code>scipy.stats.shapiro</code>, l'hypothèse nulle étant que les étant que les observations sont normalement distribuées, on souhaite encore une fois une p-value élevée pour ne pas rejeter <span class="math">\(H_0\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
<span class="n">shapiro</span><span class="p">(</span><span class="n">res3</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">13</span><span class="p">:])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>ShapiroResult(statistic=0.9908484220504761, pvalue=0.547280490398407)
</code></pre></div>

<p>Le test de normalité est également validé pour ce modèle et on peut afficher les résidus pour le visualiser :</p>
<div class="highlight"><pre><span></span><code><span class="n">res3</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_31_0.png"></p>
<h2 id="prevision-de-lannee-1961-avec-le-modele-retenu">Prévision de l’année 1961 avec le modèle retenu</h2>
<p>Maintenant qu'on a modélisé notre série, on peut se servir de ce modèle pour faire des prédictions avec la méthode <code>get_forecast()</code></p>
<div class="highlight"><pre><span></span><code><span class="c1"># prédiction et intervalles de confiance</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">res3</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">predicted_mean</span><span class="p">)</span>
<span class="n">x_pred_inf</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)]</span>
<span class="n">x_pred_sup</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)]</span>

<span class="c1"># affichage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Passagers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="n">x_pred_inf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">),</span> <span class="n">x_pred_sup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_33_0.png"></p>
<h2 id="evaluation-de-la-qualite-predictive-du-modele">Évaluation de la qualité prédictive du modèle</h2>
<p>On n'en a pas parlé jusqu'ici mais pour construire un modèle prédictif, il faut mettre en place, entraîner, tester et évaluer votre modèle. Pour cela, il est nécessaire de découper nos données en échantillons d'entraînement et de test. Pour des observations non chronologiques, on découpe de manière aléatoire mais pour des données temporelles, on est obligé de conserver la chronologie dans l'échantillon d'entraînement. Pour cela, on va tout simplement tronquer la série : les <strong>données d'entraînement sont les observations jusqu'en 1958</strong> et les <strong>données de test sont celles des années 1959 et 1960</strong>.</p>
<p>On va utiliser directement le modèle <span class="math">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span> obtenu avec toutes les observations de la série. Toutefois, il est plus rigoureux de s'assurer que le modèle retenu précédemment est toujours valide sur la série tronquée <code>y_train</code>. Pour cela on regarde la significativité des coefficients, l'autocorrélation et la normalité des résidus.</p>
<p>Le modèle <span class="math">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span> étant bien valide sur les données tronquées, on peut prédire les valeurs des années 1959 et 1960 et les afficher sur le graphique suivant avec les valeurs réelles, prédites et les intervalles de confiance.</p>
<p>Enfin, on ajoute des métriques d'erreur : RMSE et MAPE.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># série x : série des passagers</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;1958&#39;</span><span class="p">,</span> <span class="s1">&#39;Airpass&#39;</span><span class="p">]</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1959&#39;</span><span class="p">:,</span> <span class="s1">&#39;Airpass&#39;</span><span class="p">]</span>
<span class="c1"># série y=log(x) : transformation logarithmique de la série des passagers </span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;1958&#39;</span><span class="p">,</span> <span class="s1">&#39;Airpass&#39;</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1959&#39;</span><span class="p">:,</span> <span class="s1">&#39;Airpass&#39;</span><span class="p">]</span>

<span class="c1"># modélisation et summary</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># test d&#39;autocorrélation des résidus</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Retard : p-value&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">36</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lag</span><span class="p">,</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lag</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>

<span class="c1"># test de normalité des résidus</span>
<span class="nb">print</span><span class="p">(</span><span class="n">shapiro</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">13</span><span class="p">:]))</span>

<span class="c1"># prédiction et intervalles de confiance</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span>
<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">predicted_mean</span><span class="p">)</span>
<span class="n">x_pred_inf</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)]</span>
<span class="n">x_pred_sup</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)]</span>

<span class="c1"># graphique</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Passagers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x_pred_inf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">x_pred_sup</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># métriques</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">x_test</span><span class="o">-</span><span class="n">x_pred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x_pred</span><span class="o">/</span><span class="n">x_test</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE = </span><span class="si">{}</span><span class="s2"> et MAPE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="n">mape</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                     SARIMAX Results                                      
==========================================================================================
Dep. Variable:                                  y   No. Observations:                  120
Model:             SARIMAX(0, 1, 1)x(0, 1, 1, 12)   Log Likelihood                 197.505
Date:                            Wed, 09 Nov 2022   AIC                           -389.010
Time:                                    15:47:24   BIC                           -380.991
Sample:                                         0   HQIC                          -385.759
                                            - 120                                         
<span class="gh">Covariance Type:                              opg                                         </span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ma.L1         -0.3422      0.087     -3.921      0.000      -0.513      -0.171
ma.S.L12      -0.5407      0.105     -5.158      0.000      -0.746      -0.335
<span class="gh">sigma2         0.0014      0.000      7.867      0.000       0.001       0.002</span>
<span class="gh">===================================================================================</span>
Ljung-Box (L1) (Q):                   0.01   Jarque-Bera (JB):                 0.94
Prob(Q):                              0.92   Prob(JB):                         0.63
Heteroskedasticity (H):               0.37   Skew:                             0.12
<span class="gh">Prob(H) (two-sided):                  0.00   Kurtosis:                         3.39</span>
<span class="gh">===================================================================================</span>

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
Retard : p-value
6 : 0.9843609885289526
12 : 0.9115568666108983
18 : 0.6472654644765928
24 : 0.5846032458884963
30 : 0.6111276421562357
36 : 0.6613716515087891
ShapiroResult(statistic=0.9883859157562256, pvalue=0.48699426651000977)
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_35_1.png"></p>
<div class="highlight"><pre><span></span><code>RMSE = 43.18024430485034 et MAPE = 8.51556515346472
</code></pre></div>

<p>Ainsi on obtient su les 2 années 1959 et 1960, une erreur moyenne de prédiction de 43,2 passagers (RMSE) et une erreur moyenne absolue en pourcentage de 8,5%.</p>
<h2 id="une-autre-approche-pour-la-determination-du-modele">Une autre approche pour la détermination du modèle</h2>
<p>Pour ajuster un modèle SARIMA aux données d'une série temporelle, il faut déterminer le jeu de paramètres <span class="math">\((p,d,q)(P,D,Q)s\)</span> optimaux. On peut faire de la recherche sur grille qui consiste à tester de manière itérative plusieurs valeurs possibles des paramètres et d'évaluer les modèles en utilisant des critères tels que AIC ou BIC.</p>
<p>On utilisera nous le critère d'information Akaike (<span class="math">\(AIC\)</span>) qui mesure la qualité relative des modèles statistiques pour un ensemble d'observations donné. À partir d'un ensemble de modèles, le critère <span class="math">\(AIC\)</span> permet d'estimer la qualité de chacun des modèles par rapport aux autres. Cela permet donc de sélectionner des modèles. Intuitivement, le critère <span class="math">\(AIC\)</span> mesure le compromis entre la qualité de l'ajustement du modèle aux observations fournies et la complexité du modèle (nombre de paramètres inclus et estimés). Le critère <span class="math">\(AIC\)</span> est calculé par :</p>
<p><span class="math">\(AIC=2k-2ln(L)\)</span> avec :
- <span class="math">\(k\)</span> nombre de paramètres estimés
- <span class="math">\(L\)</span> valeur maximale de la vraisemblance (pour simplifier maximiser la vraisemblance revient plus ou moins à minimiser l'erreur)</p>
<p>Le meilleur modèle est celui qui minimise le critère <span class="math">\(AIC\)</span>. À titre de comparaison, on regarde aussi selon le critère BIC.</p>
<p>Dans on premier temps, on va générer toutes les valeurs possibles des paramètres que nous aimerions évaluer, à savoir <span class="math">\((p,d,q)(P,D,Q)\)</span> puisqu'on sait déjà que <span class="math">\(s=12\)</span>. On testera les modèles pour toutes les combinaisons possibles pour des valeurs entre 0 et 1 pour chacun des 6 paramètres c'est-à-dire <span class="math">\(2^6 = 64\)</span> possibilités. Si on va jusqu'à 2 pour chaque paramêtre, on passe à <span class="math">\(3^6 = 729\)</span> possibilités, ce qui va commencer à faire un peu long...</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.sarimax</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1">#&#39;once&#39; pour afficher le warning une seule fois</span>

<span class="c1"># on génère toutes les combinaisons possibles des paramèters</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">d</span> <span class="o">=</span> <span class="n">q</span> <span class="o">=</span> <span class="n">P</span> <span class="o">=</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span>

<span class="c1"># on initialise nos paramètres optimaux</span>
<span class="n">tmp_model</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pdq&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;PDQ&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="s1">&#39;bic&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">}</span>
<span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pdq&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;PDQ&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="s1">&#39;bic&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">}</span>

<span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Q</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">tmp_model</span> <span class="o">=</span> <span class="n">SARIMAX</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span>
                        <span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">q</span><span class="p">),</span>
                        <span class="n">seasonal_order</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
                        <span class="n">enforce_stationarity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">enforce_invertibility</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">tmp_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">aic</span> <span class="o">&lt;</span> <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;aic&#39;</span><span class="p">]:</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">aic</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">bic</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;pdq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;PDQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">bic</span> <span class="o">&lt;</span> <span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;bic&#39;</span><span class="p">]:</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">aic</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">bic</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;pdq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;PDQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
        <span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modèle retenu selon le critère AIC : SARIMA</span><span class="si">{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;pdq&#39;</span><span class="p">]</span><span class="si">}{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;PDQ&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">12 - AIC:</span><span class="si">{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - BIC:</span><span class="si">{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modèle retenu selon le critère BIC : SARIMA</span><span class="si">{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;pdq&#39;</span><span class="p">]</span><span class="si">}{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;PDQ&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">12 - AIC:</span><span class="si">{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;aic&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - BIC:</span><span class="si">{</span><span class="n">best</span><span class="p">[</span><span class="s1">&#39;bic&#39;</span><span class="p">][</span><span class="s1">&#39;bic&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="mi">100</span><span class="c1">%|███████████████████████████████████████████| 64/64 [00:59&lt;00:00,  1.08it/s]</span>

<span class="nv">Modèle</span> <span class="s s-Atom">retenu</span> <span class="s s-Atom">selon</span> <span class="s s-Atom">le</span> <span class="s s-Atom">critère</span> <span class="nv">AIC</span> <span class="o">:</span> <span class="nv">SARIMA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="mi">12</span> <span class="o">-</span> <span class="nv">AIC</span><span class="o">:-</span><span class="mf">405.4220890824692</span> <span class="o">-</span> <span class="nv">BIC</span><span class="o">:-</span><span class="mf">394.3055951100231</span>
<span class="nv">Modèle</span> <span class="s s-Atom">retenu</span> <span class="s s-Atom">selon</span> <span class="s s-Atom">le</span> <span class="s s-Atom">critère</span> <span class="nv">BIC</span> <span class="o">:</span> <span class="nv">SARIMA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="mi">12</span> <span class="o">-</span> <span class="nv">AIC</span><span class="o">:-</span><span class="mf">405.4220890824692</span> <span class="o">-</span> <span class="nv">BIC</span><span class="o">:-</span><span class="mf">394.3055951100231</span>
</code></pre></div>

<p>Le meilleur modèle selon le critère AIC est le <span class="math">\(SARIMA(0,1,1)(1,0,1)_{12}\)</span> qui diffère légèrement de celui obtenu avec la méthode précédente. Il convient de noter cependant que le modèle précédent <span class="math">\(SARIMA(0,1,1)(0,1,1)_{12}\)</span> a été obtenu sur toutes les observations.</p>
<p>Passons à la prédiction pour terminer.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># modèle retenu</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">best</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>

<span class="c1"># summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># résidus</span>
<span class="n">res</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test de Shapiro :&quot;</span><span class="p">,</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="mi">13</span><span class="p">:]))</span>

<span class="c1"># prédiction et intervalles de confiance</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;1958-12-01&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;1960-12-01&#39;</span><span class="p">))</span>
<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">predicted_mean</span><span class="p">)</span>
<span class="n">pred_CI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">conf_int</span><span class="p">())</span>

<span class="c1"># affichage</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;1949&#39;</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Série observée&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkturquoise&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">x_pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prévisions&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;deeppink&#39;</span><span class="p">)</span>

<span class="c1"># affichage de l&#39;intervalle de confiance</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pred_CI</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pred_CI</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">pred_CI</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;plum&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>

<span class="c1"># un peu de style</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">(),</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;1958-12-01&#39;</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Passagers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># métriques</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">x_test</span><span class="o">-</span><span class="n">x_pred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x_pred</span><span class="o">/</span><span class="n">x_test</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE = </span><span class="si">{}</span><span class="s2"> et MAPE = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="n">mape</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>                                     SARIMAX Results                                      
==========================================================================================
Dep. Variable:                            Airpass   No. Observations:                  120
Model:             SARIMAX(0, 1, 1)x(1, 0, 1, 12)   Log Likelihood                 206.711
Date:                            Wed, 09 Nov 2022   AIC                           -405.422
Time:                                    15:48:24   BIC                           -394.306
Sample:                                01-01-1949   HQIC                          -400.908
                                     - 12-01-1958                                         
<span class="gh">Covariance Type:                              opg                                         </span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ma.L1         -0.2909      0.082     -3.544      0.000      -0.452      -0.130
ar.S.L12       0.9888      0.009    110.418      0.000       0.971       1.006
ma.S.L12      -0.5472      0.107     -5.121      0.000      -0.757      -0.338
<span class="gh">sigma2         0.0014      0.000      7.899      0.000       0.001       0.002</span>
<span class="gh">===================================================================================</span>
Ljung-Box (L1) (Q):                   0.02   Jarque-Bera (JB):                 0.46
Prob(Q):                              0.89   Prob(JB):                         0.79
Heteroskedasticity (H):               0.43   Skew:                             0.11
<span class="gh">Prob(H) (two-sided):                  0.01   Kurtosis:                         3.22</span>
<span class="gh">===================================================================================</span>

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
Test de Shapiro : ShapiroResult(statistic=0.988020658493042, pvalue=0.459557443857193)
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp4/output_39_1.png"></p>
<p><img alt="Pelican" src="../images/SeriesTemp4/output_39_2.png"></p>
<div class="highlight"><pre><span></span><code>RMSE = 47.11786986382567 et MAPE = 9.220540274482799
</code></pre></div>

<p>Le RMSE et le MAPE sont légèrement plus élevés qu'avec le précédent modèle mais restent dans les mêmes ordres de grandeur. On notera donc que dans ce cas précis, l'approche par critère d'information ne permet pas d'avoir les meilleurs résultats de prédiction sur les années 1959 et 1960. Toutefois l'approche étant plus exhaustive puisqu'on compare un grand nombre de modèle, elle mérite d'être conservée. Cette réflexion entre dans le cadre de la sélection de modèles si vous voulez en savoir plus.</p>
<h1 id="pour-aller-plus-loin">Pour aller plus loin</h1>
<p>On va s'arrêter là pour cet article qui est déjà bien assez long mais si vous souhaitez creuser un peu sur les séries temporelles, voici quelques pistes de recherche :<br>
- la <strong>cointégration</strong> : lorsqu'une relation de long terme semble exister entre deux séries<br>
- le <strong>modèle à correction d'erreur</strong> et la notion associée de vitesse d'ajustement<br>
- d'autres modèles adaptés adaptés aux séries temporelles : <strong>Prophet</strong> ou encore les réseaux de neurones réccurents avec notamment les <strong>LSTM</strong>. Tiens tiens, mais ce serait pas une bonne idée pour un petit "Bonus Series Temp" ? Allez d'accord !  </p>
<p>C'est la fin de cet article! N'hésitez pas à <a href="https://www.statoscop.fr">visiter notre site</a> et à nous suivre sur <a href="https://twitter.com/stato_scop">Twitter</a> et <a href="https://www.linkedin.com/company/statoscop">Linkedin</a>. Pour retrouver l'ensemble du code ayant servi à générer cette note, vous pouvez vous rendre sur le <a href="https://github.com/Statoscop/notebooks-blog">github de Statoscop</a>.  </p>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Les séries temporelles avec Python (4/4) - Analyse et modélisation&amp;url=https://blog.statoscop.fr/timeseries-4.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://blog.statoscop.fr/tag/python.html">Python</a><a href="https://blog.statoscop.fr/tag/machine-learning.html">Machine Learning</a><a href="https://blog.statoscop.fr/tag/statistiques.html">Statistiques</a><a href="https://blog.statoscop.fr/tag/data-science.html">Data Science</a><a href="https://blog.statoscop.fr/tag/series-temporelles.html">Séries temporelles</a><a href="https://blog.statoscop.fr/tag/datetime.html">Datetime</a><a href="https://blog.statoscop.fr/tag/arma.html">ARMA</a><a href="https://blog.statoscop.fr/tag/sarima.html">SARIMA</a><a href="https://blog.statoscop.fr/tag/time-series.html">Time Series</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
    
    <!-- Footer-->
    <footer class="footer py-4">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-4 text-lg-left"> © Statoscop</div>
                <div class="col-lg-4 my-3 my-lg-0">
                    <a class="btn btn-dark btn-social mx-2" href="https://twitter.com/stato_scop" target="_blank"><i class="fab fa-twitter"></i></a>
                </div>
                <div class="col-lg-4 text-lg-left"> 
                    Blog publié avec <a class="js-scroll-trigger text-info" href="https://docs.getpelican.com/en/latest/"  target="_blank">Pelican</a> et
                     déployé sur <a class="js-scroll-trigger text-info" href="https://pages.github.com/"  target="_blank">Github Pages</a>.
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script type="text/javascript" src="https://blog.statoscop.fr/themes/statoscop/static/js/script.js"></script>

  </body>
</html>
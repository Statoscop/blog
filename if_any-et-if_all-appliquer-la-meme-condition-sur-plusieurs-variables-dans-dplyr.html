<!DOCTYPE html>
<html lang="fr">

<head>
<title>if_any et if_all : appliquer la m√™me condition sur plusieurs variables dans dplyr</title>    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="Le blog statistiques et data science de la coop√©rative Statoscop" />
  <meta name="author" content="" />

  <!-- Font Awesome icons (free version)-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />



  <!-- <title>Le blog de Statoscop - √©tudes de cas en R et Python</title> -->
  <link rel="icon" type="image/x-icon" href="https://blog.statoscop.fr/themes/statoscop/static/images/favicon-v1.ico" />


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://blog.statoscop.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Full Atom Feed" />
          <link href="https://blog.statoscop.fr/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Categories Atom Feed" />

  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style.css" type="text/css" rel="stylesheet" />-->
  <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style-site.css" type="text/css" rel="stylesheet" /> 
  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style_fusion.css" type="text/css" rel="stylesheet" /> -->
  <!-- Code highlight color scheme -->
      <link href="https://blog.statoscop.fr/themes/statoscop/static/css/code_blocks/github.css" rel="stylesheet">

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!-- [if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  ![endif] -->



    <meta name="description" content="Quelques exemples d'utilisation de if_any et if_all dans le traitement de vos donn√©es avec R.">

    <meta name="author" content="Antoine">

    <meta name="tags" content="R">
    <meta name="tags" content="dplyr">
    <meta name="tags" content="tidyverse">
    <meta name="tags" content="if_any">
    <meta name="tags" content="if_all">
    <meta name="tags" content="across">




<!-- Open Graph -->
<meta property="og:site_name" content="Le blog"/>
<meta property="og:title" content="if_any et if_all : appliquer la m√™me condition sur plusieurs variables dans dplyr"/>
<meta property="og:description" content="Quelques exemples d'utilisation de if_any et if_all dans le traitement de vos donn√©es avec R."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2025-04-03 00:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://blog.statoscop.fr/author/antoine.html">
<meta property="article:section" content="R"/>
<meta property="article:tag" content="R"/>
<meta property="article:tag" content="dplyr"/>
<meta property="article:tag" content="tidyverse"/>
<meta property="article:tag" content="if_any"/>
<meta property="article:tag" content="if_all"/>
<meta property="article:tag" content="across"/>
<meta property="og:image" content="https://blog.statoscop.fr/images/cover_23.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "if_any et if_all : appliquer la m√™me condition sur plusieurs variables dans dplyr",
  "headline": "if_any et if_all : appliquer la m√™me condition sur plusieurs variables dans dplyr",
  "datePublished": "2025-04-03 00:00:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Antoine",
    "url": "https://blog.statoscop.fr/author/antoine.html"
  },
  "image": "https://blog.statoscop.fr/images/cover_23.png",
  "url": "https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html",
  "description": "Quelques exemples d'utilisation de if_any et if_all dans le traitement de vos donn√©es avec R."
}
</script>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//matomo.statoscop.fr/matomo/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  

</head>
<!-- TODO : Body class -->
  <body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">

        <a class="navbar-brand" href="https://statoscop.fr"><img src="https://blog.statoscop.fr/themes/statoscop/static/images/logo-statoscop-v1.png" alt="Statoscop.logo"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr"> Accueil </a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/about"> √Ä propos </a>
              </li>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle font-weight-bold "
                  id="navbarDropdownMenuLink" aria-haspopup="true" aria-expanded="false"> Prestations </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      <li><a class="dropdown-item" href="https://statoscop.fr/etudes">Conseils & √©tudes statistiques</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/recodages">Migrations de code & Recodages</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/formations">Formations</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/applis">Dashboards & Applications</a></li>
                  </ul>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/contact">Contact</a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger active" href="https://blog.statoscop.fr/">Le blog</a>
              </li>
          </ul>
      </div>
      </div>
    </nav>
    


    <!-- Post content -->
    <main class="content" role="main">
      
      <div>
      </div>

      <article class="post">
        <div class="inner">




            <section class="post-content">
              <h1 class="post-title">if_any et if_all : appliquer la m√™me condition sur plusieurs variables dans dplyr</h1>
                <!-- Le titres et meta infos-->
                <span class="post-meta">
                        <a href="https://blog.statoscop.fr/author/antoine.html">Antoine</a>
                    | <time datetime="jeu. 03 avril 2025">jeu. 03 avril 2025</time>
                </span>

                <!--Table des matieres
-->
                
                <div class="toc"><span class="toctitle">Dans cet article</span><ul>
<li><a href="#syntaxe-de-if_any-et-if_all">Syntaxe de if_any et if_all</a></li>
<li><a href="#filtrer-un-dataframe-avec-if_any-et-if_all">Filtrer un dataframe avec if_any et if_all</a><ul>
<li><a href="#reperer-des-valeurs-en-particulier-avec-if_any">Rep√©rer des valeurs en particulier avec if_any</a></li>
<li><a href="#reperer-les-tres-bons-ou-les-tres-mauvais-resultats-avec-if_all">Rep√©rer les tr√®s bons (ou les tr√®s mauvais) r√©sultats avec if_all</a></li>
</ul>
</li>
<li><a href="#creer-une-variable-synthetique-avec-if_any-et-if_all-dans-case_when">Cr√©er une variable synth√©tique avec if_any et if_all dans case_when</a></li>
</ul>
</div>
<p>Au d√©but de l'ann√©e 2021, <a href="https://www.tidyverse.org/blog/2021/02/dplyr-1-0-4-if-any/">la sortie de dplyr 1.0.4</a> consacre l'arriv√©e de deux petits nouveaux : <code>if_any</code> et <code>if_all</code>. Ces deux fonctions viennent notamment <strong>compl√©ter le verbe <code>across</code></strong>, qui avait √©t√© introduit quelques mois plus t√¥t dans dplyr 1.0.0, et <a href="https://blog.statoscop.fr/fonctionnement-et-performances-dacross-dans-dplyr.html">que nous avons d√©j√† pr√©sent√© dans un pr√©c√©dent article</a>.<br>
Ici nous vous proposons donc un rapide tour des possibilit√©s offertes par ces fonctions. Nous commen√ßons par montrer comment ils peuvent √™tre utilis√©s dans <code>filter()</code> pour filtrer facilement notre dataframe <strong>en appliquant la m√™me condition √† plusieurs variables</strong>. Puis nous montrons comment ils peuvent √™tre avantageusement <strong>utilis√©s dans des instructions <code>mutate()</code> pour synth√©tiser les valeurs de plusieurs variables</strong>. </p>
<h1 id="syntaxe-de-if_any-et-if_all">Syntaxe de <code>if_any</code> et <code>if_all</code></h1>
<p>La syntaxe de ces deux verbes est exactement la m√™me que celle d'<code>across()</code> :  </p>
<div class="highlight"><pre><span></span><code><span class="nf">if_any</span><span class="p">(</span><span class="n">.cols</span><span class="p">,</span><span class="w"> </span><span class="n">.fns</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="nf">if_all</span><span class="p">(</span><span class="n">.cols</span><span class="p">,</span><span class="w"> </span><span class="n">.fns</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
</code></pre></div>

<p>Comme pour <code>across</code>, <strong>le param√®tre <code>.cols</code> permet de s√©lectionner les variables</strong> sur lesquelles on souhaite appliquer notre filtre. Pour cela on utilise les m√©thodes du <code>tidyselect</code> :<br>
- <code>where(fn)</code> pour s√©lectionner les colonnes sur une condition (<code>where(is.numeric)</code> par exemple).<br>
- <code>starts_with(match)</code>, <code>ends_with(match)</code>, <code>contains(match)</code>, <code>matches(match)</code> pour s√©lectionner les variables sur une caract√©ristique de leur nom (<code>starts_with("v_")</code> par exemple). <br>
- <code>c(var1, var2, var3)</code>, <code>all_of(c("var1", "var2", "var3"))</code> ou <code>any_of(c("var1", "var2", "var3"))</code> pour s√©lectionner directement les variables par leur nom.   </p>
<p>Le <strong>param√®tre <code>.fns</code> permet de d√©finir la fonction de filtrage</strong> sur les variables s√©lectionn√©es. Ce sera soit une fonction d√©j√† existante (<code>is.na</code> par exemple), soit une fonction d√©finie en par l'utilisateur en amont ou √† la vol√©e (avec la syntaxe <code>~ .x &gt; 50</code> par exemple).   </p>
<p>Ces deux fonctions vont <strong>cr√©er en sortie un vecteur bool√©en</strong> qui va nous permettre de filtrer nos observations de deux fa√ßons :   </p>
<ul>
<li>avec <code>if_any</code> si la condition d√©finie dans <code>.fns</code> est respect√©e pour au moins une des variables. Cela revient √† <strong>coder la condition pour chaque colonne avec l'op√©rateur <code>|</code> (<code>OU</code>).</strong>   </li>
<li>avec <code>if_all</code> si cette condition est respect√©e pour toutes les variables. Cela revient √† <strong>coder la condition pour chaque colonne avec l'op√©rateur <code>&amp;</code> (<code>ET</code>).</strong> </li>
</ul>
<p>Voyons concr√®tement comment nous pouvons les utiliser dans deux cas distincts : <strong>filtrer notre dataframe</strong> sur une conditions portant sur plusieurs variables √† la fois et <strong>cr√©er une nouvelle variable en fonction des valeurs de plusieurs autres variables</strong>.    </p>
<blockquote>
<p>üëã Nous c'est Antoine et Louis de Statoscop, une coop√©rative de statisticiens / data scientists.
Vous voulez en savoir plus sur ce que l'on fait?</p>
</blockquote>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br>        </p>
<h1 id="filtrer-un-dataframe-avec-if_any-et-if_all">Filtrer un dataframe avec <code>if_any</code> et <code>if_all</code></h1>
<p>Pour <strong>illustrer l'utilisation de ces deux verbes</strong>, on s'appuie sur <a href="https://www.kaggle.com/datasets/simranjitkhehra/student-grades-dataset">des donn√©es Kaggle de notes d'√©tudiants √† diff√©rentes mati√®res</a>. On a modifi√© ces donn√©es pour avoir <strong>une colonne pour chaque note de chaque mati√®re</strong>. Notre dataset <code>stud_grades</code> a maintenant ce format :  </p>
<div class="highlight"><pre><span></span><code><span class="gu">##</span> Rows: 10,000
<span class="gu">##</span> Columns: 6
<span class="gu">##</span> $ student.id         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, ‚Ä¶
<span class="gu">##</span> $ math               &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;, &quot;D&quot;, &quot;F&quot;, &quot;A&quot;, &quot;F&quot;, &quot;‚Ä¶
<span class="gu">##</span> $ science            &lt;chr&gt; &quot;C&quot;, &quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;C&quot;, &quot;F&quot;, &quot;F&quot;, &quot;C&quot;, &quot;A&quot;, &quot;‚Ä¶
<span class="gu">##</span> $ history            &lt;chr&gt; &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;F&quot;, &quot;C&quot;, &quot;C&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;B&quot;, &quot;‚Ä¶
<span class="gu">##</span> $ english            &lt;chr&gt; &quot;F&quot;, &quot;C&quot;, &quot;A&quot;, &quot;D&quot;, &quot;A&quot;, &quot;C&quot;, &quot;D&quot;, &quot;C&quot;, &quot;F&quot;, &quot;F&quot;, &quot;‚Ä¶
<span class="gu">##</span> $ physical_education &lt;chr&gt; &quot;C&quot;, &quot;A&quot;, &quot;C&quot;, &quot;B&quot;, &quot;C&quot;, &quot;F&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;F&quot;, &quot;‚Ä¶
</code></pre></div>

<p>Les notes possibles sont <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> et <code>F</code>.   </p>
<p>On pr√©sente plusieurs op√©rations de filtrage qui peuvent √™tre utiles dans notre exploration des donn√©es.  </p>
<h2 id="reperer-des-valeurs-en-particulier-avec-if_any">Rep√©rer des valeurs en particulier avec <code>if_any</code></h2>
<p>La premi√®re question que l'on peut se poser est de savoir s'il manque des informations dans notre dataset. <code>if_any</code> va nous permettre de renvoyer les lignes contenant <strong>au moins une valeur manquante</strong> parmi les variables que l'on s√©lectionne :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">physical_education</span><span class="p">),</span><span class="w"> </span><span class="n">is.na</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">print</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">## # A tibble: 0 √ó 6</span>
<span class="c1">## # ‚Ñπ 6 variables: student.id &lt;int&gt;, math &lt;chr&gt;, science &lt;chr&gt;, history &lt;chr&gt;,</span>
<span class="c1">## #   english &lt;chr&gt;, physical_education &lt;chr&gt;</span>
</code></pre></div>

<p>On voit tout de suite que le dataframe ne contient pas de valeurs manquantes, d'une mani√®re plus directe et √©l√©gante que de coder la condition <code>is.na(math) | is.na(science) | is.na(history) | is.na(english) | is.na(physical_education)</code>.   </p>
<p>Dans la m√™me logique on pourrait vouloir identifier <strong>les cas o√π des √©l√®ves ont re√ßu la note "F"</strong> :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># On d√©finit ici notre fonction &quot;√† la vol√©e&quot; avec ~ function(.x)</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">physical_education</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># on renvoie le nombre d&#39;observations</span>
<span class="w">  </span><span class="nf">nrow</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>## [1] 6749
</code></pre></div>

<p>On apprend ainsi que 6749 √©l√®ves sur 10 000 ont eu au moins un F √† une des mati√®res!  </p>
<h2 id="reperer-les-tres-bons-ou-les-tres-mauvais-resultats-avec-if_all">Rep√©rer les tr√®s bons (ou les tr√®s mauvais) r√©sultats avec <code>if_all</code></h2>
<p>Avec <code>if_all</code>, on peut facilement rep√©rer les excellents r√©sultats en filtrant par exemple sur les √©l√®ves <strong>ayant eu des "A" √† toutes les mati√®res</strong> :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># notez qu&#39;on s√©lectionne les m√™mes colonnes que pr√©c√©demment</span>
<span class="w">  </span><span class="c1"># avec une m√©thode diff√©rente</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">if_all</span><span class="p">(</span><span class="nf">where</span><span class="p">(</span><span class="n">is.character</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">print</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="gu">##</span> # A tibble: 2 √ó 6
<span class="gu">##</span>   student.id math  science history english physical_education
<span class="gu">##</span>        &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;             
<span class="gu">##</span> 1       6933 A     A       A       A       A                 
<span class="gu">##</span> 2       8749 A     A       A       A       A
</code></pre></div>

<p>On voit ainsi directement que seulement deux √©l√®ves ont r√©ussi cet exploit, avec une syntaxe bien plus directe que de coder <code>math == "A" &amp; science == "A" &amp; history == "A" &amp; english == "A" &amp; physical_education == "A"</code>.    </p>
<p>On peut bien s√ªr √©galement <strong>rep√©rer les √©l√®ves en difficult√©</strong>, en regardant ceux qui n'ont eu que des "F" √† toutes les mati√®res.</p>
<h1 id="creer-une-variable-synthetique-avec-if_any-et-if_all-dans-case_when">Cr√©er une variable synth√©tique avec <code>if_any</code> et <code>if_all</code> dans <code>case_when</code></h1>
<p>On conclut cet article en vous montrant <strong>comment profiter avantageusement de ces verbes dans une instruction <code>mutate()</code></strong>, dans le but par exemple de <strong>cr√©er une variable synth√©thique</strong> qui prenne en compte l'ensemble de ces notes. Les modalit√©s pourraient √™tre les suivantes :  </p>
<p>1 - <em>Facilit√©s en sciences et en lettres</em> (au moins B dans toutes ces mati√®res)<br>
2 - <em>Facilit√©s en sciences, difficult√©s en lettres</em> (au moins B en maths et science, C ou moins dans une mati√®re litt√©raire)<br>
3 - <em>Facilit√©s en lettres, difficult√©s en sciences</em> (au moins B en histoire et anglais, C ou moins dans une mati√®re scientifique)<br>
4 - <em>Difficult√©s en lettres et sciences</em> (jamais mieux que C dans aucune de ces 4 mati√®res) <br>
5 - <em>Difficult√©s surtout en sciences</em> (jamais mieux que C dans une mati√®re scientifique) <br>
6 - <em>Difficult√©s surtout en lettres</em> (jamais mieux que C dans une mati√®re litt√©raire) <br>
7 - <em>R√©sultats irr√©guliers</em> (aucune des conditions pr√©c√©dentes : donc bons r√©sultats dans seulement au moins une des mati√®res scientifiques et litt√©raire)   </p>
<p>Ces conditions s'√©crivent ainsi :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="n">lvl_sc_lit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">case_when</span><span class="p">(</span>
<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Facilit√©s en sciences et en lettres&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">               </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Facilit√©s en sciences, difficult√©s en lettres&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">               </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Facilit√©s en lettres, difficult√©s en sciences&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Difficult√©s en lettres et sciences&quot;</span><span class="p">,</span><span class="w"> </span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">        </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Difficult√©s surtout en sciences&quot;</span><span class="p">,</span><span class="w"> </span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">        </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Difficult√©s surtout en lettres&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;R√©sultats irr√©guliers&quot;</span><span class="p">))</span>
</code></pre></div>

<p>On voit ainsi <strong>qu'on peut combiner des conditions de <code>if_any</code> et <code>if_all</code> avec les <code>&amp;</code> et <code>|</code></strong>, ce qui permet une grande flexibilit√© dans la cr√©ation de nos conditions. On utilise √©galement le param√®tre <code>TRUE</code> de <code>case_when</code> pour tous les cas ne tombant dans aucune des conditions que nous avons imagin√©es, c'est √† dire les √©l√®ves n'ayant pas de profil particuli√®rement litt√©raire ou scientifique mais plut√¥t des r√©sultats tr√®s irr√©guliers dans les diff√©rentes mati√®res. Voici comment se r√©partissent nos √©l√®ves dans cette nouvelle variable synth√©tique :     </p>
<div class="highlight"><pre><span></span><code><span class="gu">##</span> # A tibble: 7 √ó 2
<span class="gu">##</span>   lvl_sc_lit                                        n
<span class="gu">##</span>   &lt;chr&gt;                                         &lt;int&gt;
<span class="gu">##</span> 1 Difficult√©s en lettres et sciences             1334
<span class="gu">##</span> 2 Difficult√©s surtout en lettres                 1790
<span class="gu">##</span> 3 Difficult√©s surtout en sciences                1678
<span class="gu">##</span> 4 Facilit√©s en lettres, difficult√©s en sciences  1334
<span class="gu">##</span> 5 Facilit√©s en sciences et en lettres             259
<span class="gu">##</span> 6 Facilit√©s en sciences, difficult√©s en lettres  1337
<span class="gu">##</span> 7 R√©sultats irr√©guliers                          2268
</code></pre></div>

<p>C'est tout pour aujourd'hui! On esp√®re que cette note vous permettra de mieux exploiter la puissance de ces deux petits verbes bien pratiques. Si vous avez besoin de <a href="https://statoscop.fr">conseils en programmation pour l'analyse de donn√©es</a>, n'h√©sitez pas √† continuer votre navigation sur notre site ou √† nous suivre sur <a href="https://bsky.app/profile/statoscop.fr">BlueSky</a> et <a href="https://www.linkedin.com/company/statoscop">Linkedin</a>. Pour retrouver l'ensemble du code ayant servi √† g√©n√©rer cette note, vous pouvez vous rendre sur le <a href="https://github.com/Statoscop/notebooks-blog">github de Statoscop</a>.  </p>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br>  </p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=if_any et if_all : appliquer la m√™me condition sur plusieurs variables dans dplyr&amp;url=https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://blog.statoscop.fr/tag/r.html">R</a><a href="https://blog.statoscop.fr/tag/dplyr.html">dplyr</a><a href="https://blog.statoscop.fr/tag/tidyverse.html">tidyverse</a><a href="https://blog.statoscop.fr/tag/if_any.html">if_any</a><a href="https://blog.statoscop.fr/tag/if_all.html">if_all</a><a href="https://blog.statoscop.fr/tag/across.html">across</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
    
        <!-- Footer-->
        <footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-left"> ¬© Statoscop<br> 3 rue Jacques Roudil 31300 Toulouse</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                        <a class="btn btn-dark btn-social mx-2" href="https://fr.linkedin.com/company/statoscop" target="_blank"><i class="fa-brands fa-linkedin-in"></i></a>
                    </div>
                    <div class="col-lg-4 text-lg-left"> 
                        Blog publi√© avec <a class="js-scroll-trigger text-info" href="https://docs.getpelican.com/en/latest/"  target="_blank">Pelican</a> et
                        d√©ploy√© sur <a class="js-scroll-trigger text-info" href="https://pages.github.com/"  target="_blank">Github Pages</a>.
                    </div>
                </div>
            </div>
        </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script type="text/javascript" src="https://blog.statoscop.fr/themes/statoscop/static/js/script.js"></script>

  </body>
</html>
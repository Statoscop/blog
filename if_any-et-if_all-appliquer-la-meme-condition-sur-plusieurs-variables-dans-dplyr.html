<!DOCTYPE html>
<html lang="fr">

<head>
<title>if_any et if_all : appliquer la même condition sur plusieurs variables dans dplyr</title>    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="Le blog statistiques et data science de la coopérative Statoscop" />
  <meta name="author" content="" />

  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />



  <!-- <title>Le blog de Statoscop - études de cas en R et Python</title> -->
  <link rel="icon" type="image/x-icon" href="https://blog.statoscop.fr/themes/statoscop/static/images/favicon-v1.ico" />


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://blog.statoscop.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Full Atom Feed" />
          <link href="https://blog.statoscop.fr/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Categories Atom Feed" />

  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style.css" type="text/css" rel="stylesheet" />-->
  <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style-site.css" type="text/css" rel="stylesheet" /> 
  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style_fusion.css" type="text/css" rel="stylesheet" /> -->
  <!-- Code highlight color scheme -->
      <link href="https://blog.statoscop.fr/themes/statoscop/static/css/code_blocks/github.css" rel="stylesheet">

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!-- [if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  ![endif] -->



    <meta name="description" content="Quelques exemples d'utilisation de if_any et if_all dans le traitement de vos données avec R.">

    <meta name="author" content="Antoine">

    <meta name="tags" content="R">
    <meta name="tags" content="dplyr">
    <meta name="tags" content="tidyverse">
    <meta name="tags" content="if_any">
    <meta name="tags" content="if_all">
    <meta name="tags" content="across">




<!-- Open Graph -->
<meta property="og:site_name" content="Le blog"/>
<meta property="og:title" content="if_any et if_all : appliquer la même condition sur plusieurs variables dans dplyr"/>
<meta property="og:description" content="Quelques exemples d'utilisation de if_any et if_all dans le traitement de vos données avec R."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2025-04-03 00:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://blog.statoscop.fr/author/antoine.html">
<meta property="article:section" content="R"/>
<meta property="article:tag" content="R"/>
<meta property="article:tag" content="dplyr"/>
<meta property="article:tag" content="tidyverse"/>
<meta property="article:tag" content="if_any"/>
<meta property="article:tag" content="if_all"/>
<meta property="article:tag" content="across"/>
<meta property="og:image" content="https://blog.statoscop.fr/images/cover_23.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "if_any et if_all : appliquer la même condition sur plusieurs variables dans dplyr",
  "headline": "if_any et if_all : appliquer la même condition sur plusieurs variables dans dplyr",
  "datePublished": "2025-04-03 00:00:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Antoine",
    "url": "https://blog.statoscop.fr/author/antoine.html"
  },
  "image": "https://blog.statoscop.fr/images/cover_23.png",
  "url": "https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html",
  "description": "Quelques exemples d'utilisation de if_any et if_all dans le traitement de vos données avec R."
}
</script>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//matomo.statoscop.fr/matomo/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  

</head>
<!-- TODO : Body class -->
  <body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">

        <a class="navbar-brand" href="https://statoscop.fr"><img src="https://blog.statoscop.fr/themes/statoscop/static/images/logo-statoscop-v1.png" alt="Statoscop.logo"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr"> Accueil </a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/about"> À propos </a>
              </li>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle font-weight-bold "
                  id="navbarDropdownMenuLink" aria-haspopup="true" aria-expanded="false"> Prestations </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      <li><a class="dropdown-item" href="https://statoscop.fr/etudes">Conseils & études statistiques</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/recodages">Migrations de code & Recodages</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/formations">Formations</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/applis">Dashboards & Applications</a></li>
                  </ul>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/contact">Contact</a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger active" href="https://blog.statoscop.fr/">Le blog</a>
              </li>
          </ul>
      </div>
      </div>
    </nav>
    


    <!-- Post content -->
    <main class="content" role="main">
      
      <div>
      </div>

      <article class="post">
        <div class="inner">




            <section class="post-content">
              <h1 class="post-title">if_any et if_all : appliquer la même condition sur plusieurs variables dans dplyr</h1>
                <!-- Le titres et meta infos-->
                <span class="post-meta">
                        <a href="https://blog.statoscop.fr/author/antoine.html">Antoine</a>
                    | <time datetime="jeu. 03 avril 2025">jeu. 03 avril 2025</time>
                </span>

                <!--Table des matieres
-->
                
                <div class="toc"><span class="toctitle">Table des matières</span><ul>
<li><a href="#syntaxe-de-if_any-et-if_all">Syntaxe de if_any et if_all</a></li>
<li><a href="#filtrer-un-dataframe-avec-if_any-et-if_all">Filtrer un dataframe avec if_any et if_all</a><ul>
<li><a href="#reperer-des-valeurs-en-particulier-avec-if_any">Repérer des valeurs en particulier avec if_any</a></li>
<li><a href="#reperer-les-tres-bons-ou-les-tres-mauvais-resultats-avec-if_all">Repérer les très bons (ou les très mauvais) résultats avec if_all</a></li>
</ul>
</li>
<li><a href="#creer-une-variable-synthetique-avec-if_any-et-if_all-dans-case_when">Créer une variable synthétique avec if_any et if_all dans case_when</a></li>
</ul>
</div>
<p>Au début de l'année 2021, <a href="https://www.tidyverse.org/blog/2021/02/dplyr-1-0-4-if-any/">la sortie de dplyr 1.0.4</a> consacre l'arrivée de deux petits nouveaux : <code>if_any</code> et <code>if_all</code>. Ces deux fonctions viennent notamment <strong>compléter le verbe <code>across</code></strong>, qui avait été introduit quelques mois plus tôt dans dplyr 1.0.0, et <a href="https://blog.statoscop.fr/fonctionnement-et-performances-dacross-dans-dplyr.html">que nous avons déjà présenté dans un précédent article</a>.<br>
Ici nous vous proposons donc un rapide tour des possibilités offertes par ces fonctions. Nous commençons par montrer comment ils peuvent être utilisés dans <code>filter()</code> pour filtrer facilement notre dataframe <strong>en appliquant la même condition à plusieurs variables</strong>. Puis nous montrons comment ils peuvent être avantageusement <strong>utilisés dans des instructions <code>mutate()</code> pour synthétiser les valeurs de plusieurs variables</strong>. </p>
<h1 id="syntaxe-de-if_any-et-if_all">Syntaxe de <code>if_any</code> et <code>if_all</code></h1>
<p>La syntaxe de ces deux verbes est exactement la même que celle d'<code>across()</code> :  </p>
<div class="highlight"><pre><span></span><code><span class="nf">if_any</span><span class="p">(</span><span class="n">.cols</span><span class="p">,</span><span class="w"> </span><span class="n">.fns</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="nf">if_all</span><span class="p">(</span><span class="n">.cols</span><span class="p">,</span><span class="w"> </span><span class="n">.fns</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
</code></pre></div>

<p>Comme pour <code>across</code>, <strong>le paramètre <code>.cols</code> permet de sélectionner les variables</strong> sur lesquelles on souhaite appliquer notre filtre. Pour cela on utilise les méthodes du <code>tidyselect</code> :<br>
- <code>where(fn)</code> pour sélectionner les colonnes sur une condition (<code>where(is.numeric)</code> par exemple).<br>
- <code>starts_with(match)</code>, <code>ends_with(match)</code>, <code>contains(match)</code>, <code>matches(match)</code> pour sélectionner les variables sur une caractéristique de leur nom (<code>starts_with("v_")</code> par exemple). <br>
- <code>c(var1, var2, var3)</code>, <code>all_of(c("var1", "var2", "var3"))</code> ou <code>any_of(c("var1", "var2", "var3"))</code> pour sélectionner directement les variables par leur nom.   </p>
<p>Le <strong>paramètre <code>.fns</code> permet de définir la fonction de filtrage</strong> sur les variables sélectionnées. Ce sera soit une fonction déjà existante (<code>is.na</code> par exemple), soit une fonction définie en par l'utilisateur en amont ou à la volée (avec la syntaxe <code>~ .x &gt; 50</code> par exemple).   </p>
<p>Ces deux fonctions vont <strong>créer en sortie un vecteur booléen</strong> qui va nous permettre de filtrer nos observations de deux façons :   </p>
<ul>
<li>avec <code>if_any</code> si la condition définie dans <code>.fns</code> est respectée pour au moins une des variables. Cela revient à <strong>coder la condition pour chaque colonne avec l'opérateur <code>|</code> (<code>OU</code>).</strong>   </li>
<li>avec <code>if_all</code> si cette condition est respectée pour toutes les variables. Cela revient à <strong>coder la condition pour chaque colonne avec l'opérateur <code>&amp;</code> (<code>ET</code>).</strong> </li>
</ul>
<p>Voyons concrètement comment nous pouvons les utiliser dans deux cas distincts : <strong>filtrer notre dataframe</strong> sur une conditions portant sur plusieurs variables à la fois et <strong>créer une nouvelle variable en fonction des valeurs de plusieurs autres variables</strong>.    </p>
<blockquote>
<p>👋 Nous c'est Antoine et Louis de Statoscop, une coopérative de statisticiens / data scientists.
Vous voulez en savoir plus sur ce que l'on fait?</p>
</blockquote>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br>        </p>
<h1 id="filtrer-un-dataframe-avec-if_any-et-if_all">Filtrer un dataframe avec <code>if_any</code> et <code>if_all</code></h1>
<p>Pour <strong>illustrer l'utilisation de ces deux verbes</strong>, on s'appuie sur <a href="https://www.kaggle.com/datasets/simranjitkhehra/student-grades-dataset">des données Kaggle de notes d'étudiants à différentes matières</a>. On a modifié ces données pour avoir <strong>une colonne pour chaque note de chaque matière</strong>. Notre dataset <code>stud_grades</code> a maintenant ce format :  </p>
<div class="highlight"><pre><span></span><code><span class="gu">##</span> Rows: 10,000
<span class="gu">##</span> Columns: 6
<span class="gu">##</span> $ student.id         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, …
<span class="gu">##</span> $ math               &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;, &quot;D&quot;, &quot;F&quot;, &quot;A&quot;, &quot;F&quot;, &quot;…
<span class="gu">##</span> $ science            &lt;chr&gt; &quot;C&quot;, &quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;C&quot;, &quot;F&quot;, &quot;F&quot;, &quot;C&quot;, &quot;A&quot;, &quot;…
<span class="gu">##</span> $ history            &lt;chr&gt; &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;F&quot;, &quot;C&quot;, &quot;C&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;B&quot;, &quot;…
<span class="gu">##</span> $ english            &lt;chr&gt; &quot;F&quot;, &quot;C&quot;, &quot;A&quot;, &quot;D&quot;, &quot;A&quot;, &quot;C&quot;, &quot;D&quot;, &quot;C&quot;, &quot;F&quot;, &quot;F&quot;, &quot;…
<span class="gu">##</span> $ physical_education &lt;chr&gt; &quot;C&quot;, &quot;A&quot;, &quot;C&quot;, &quot;B&quot;, &quot;C&quot;, &quot;F&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;F&quot;, &quot;…
</code></pre></div>

<p>Les notes possibles sont <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> et <code>F</code>.   </p>
<p>On présente plusieurs opérations de filtrage qui peuvent être utiles dans notre exploration des données.  </p>
<h2 id="reperer-des-valeurs-en-particulier-avec-if_any">Repérer des valeurs en particulier avec <code>if_any</code></h2>
<p>La première question que l'on peut se poser est de savoir s'il manque des informations dans notre dataset. <code>if_any</code> va nous permettre de renvoyer les lignes contenant <strong>au moins une valeur manquante</strong> parmi les variables que l'on sélectionne :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">physical_education</span><span class="p">),</span><span class="w"> </span><span class="n">is.na</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">print</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">## # A tibble: 0 × 6</span>
<span class="c1">## # ℹ 6 variables: student.id &lt;int&gt;, math &lt;chr&gt;, science &lt;chr&gt;, history &lt;chr&gt;,</span>
<span class="c1">## #   english &lt;chr&gt;, physical_education &lt;chr&gt;</span>
</code></pre></div>

<p>On voit tout de suite que le dataframe ne contient pas de valeurs manquantes, d'une manière plus directe et élégante que de coder la condition <code>is.na(math) | is.na(science) | is.na(history) | is.na(english) | is.na(physical_education)</code>.   </p>
<p>Dans la même logique on pourrait vouloir identifier <strong>les cas où des élèves ont reçu la note "F"</strong> :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># On définit ici notre fonction &quot;à la volée&quot; avec ~ function(.x)</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">physical_education</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># on renvoie le nombre d&#39;observations</span>
<span class="w">  </span><span class="nf">nrow</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>## [1] 6749
</code></pre></div>

<p>On apprend ainsi que 6749 élèves sur 10 000 ont eu au moins un F à une des matières!  </p>
<h2 id="reperer-les-tres-bons-ou-les-tres-mauvais-resultats-avec-if_all">Repérer les très bons (ou les très mauvais) résultats avec <code>if_all</code></h2>
<p>Avec <code>if_all</code>, on peut facilement repérer les excellents résultats en filtrant par exemple sur les élèves <strong>ayant eu des "A" à toutes les matières</strong> :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># notez qu&#39;on sélectionne les mêmes colonnes que précédemment</span>
<span class="w">  </span><span class="c1"># avec une méthode différente</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">if_all</span><span class="p">(</span><span class="nf">where</span><span class="p">(</span><span class="n">is.character</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">print</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="gu">##</span> # A tibble: 2 × 6
<span class="gu">##</span>   student.id math  science history english physical_education
<span class="gu">##</span>        &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;             
<span class="gu">##</span> 1       6933 A     A       A       A       A                 
<span class="gu">##</span> 2       8749 A     A       A       A       A
</code></pre></div>

<p>On voit ainsi directement que seulement deux élèves ont réussi cet exploit, avec une syntaxe bien plus directe que de coder <code>math == "A" &amp; science == "A" &amp; history == "A" &amp; english == "A" &amp; physical_education == "A"</code>.    </p>
<p>On peut bien sûr également <strong>repérer les élèves en difficulté</strong>, en regardant ceux qui n'ont eu que des "F" à toutes les matières.</p>
<h1 id="creer-une-variable-synthetique-avec-if_any-et-if_all-dans-case_when">Créer une variable synthétique avec <code>if_any</code> et <code>if_all</code> dans <code>case_when</code></h1>
<p>On conclut cet article en vous montrant <strong>comment profiter avantageusement de ces verbes dans une instruction <code>mutate()</code></strong>, dans le but par exemple de <strong>créer une variable synthéthique</strong> qui prenne en compte l'ensemble de ces notes. Les modalités pourraient être les suivantes :  </p>
<p>1 - <em>Facilités en sciences et en lettres</em> (au moins B dans toutes ces matières)<br>
2 - <em>Facilités en sciences, difficultés en lettres</em> (au moins B en maths et science, C ou moins dans une matière littéraire)<br>
3 - <em>Facilités en lettres, difficultés en sciences</em> (au moins B en histoire et anglais, C ou moins dans une matière scientifique)<br>
4 - <em>Difficultés en lettres et sciences</em> (jamais mieux que C dans aucune de ces 4 matières) <br>
5 - <em>Difficultés surtout en sciences</em> (jamais mieux que C dans une matière scientifique) <br>
6 - <em>Difficultés surtout en lettres</em> (jamais mieux que C dans une matière littéraire) <br>
7 - <em>Résultats irréguliers</em> (aucune des conditions précédentes : donc bons résultats dans seulement au moins une des matières scientifiques et littéraire)   </p>
<p>Ces conditions s'écrivent ainsi :  </p>
<div class="highlight"><pre><span></span><code><span class="n">stud_grades</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stud_grades</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="n">lvl_sc_lit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">case_when</span><span class="p">(</span>
<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Facilités en sciences et en lettres&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">               </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Facilités en sciences, difficultés en lettres&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">               </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Facilités en lettres, difficultés en sciences&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="o">:</span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Difficultés en lettres et sciences&quot;</span><span class="p">,</span><span class="w"> </span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">        </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Difficultés surtout en sciences&quot;</span><span class="p">,</span><span class="w"> </span>

<span class="w">      </span><span class="nf">if_all</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">english</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span>
<span class="w">        </span><span class="nf">if_any</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">science</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.x</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Difficultés surtout en lettres&quot;</span><span class="p">,</span>

<span class="w">      </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Résultats irréguliers&quot;</span><span class="p">))</span>
</code></pre></div>

<p>On voit ainsi <strong>qu'on peut combiner des conditions de <code>if_any</code> et <code>if_all</code> avec les <code>&amp;</code> et <code>|</code></strong>, ce qui permet une grande flexibilité dans la création de nos conditions. On utilise également le paramètre <code>TRUE</code> de <code>case_when</code> pour tous les cas ne tombant dans aucune des conditions que nous avons imaginées, c'est à dire les élèves n'ayant pas de profil particulièrement littéraire ou scientifique mais plutôt des résultats très irréguliers dans les différentes matières. Voici comment se répartissent nos élèves dans cette nouvelle variable synthétique :     </p>
<div class="highlight"><pre><span></span><code><span class="gu">##</span> # A tibble: 7 × 2
<span class="gu">##</span>   lvl_sc_lit                                        n
<span class="gu">##</span>   &lt;chr&gt;                                         &lt;int&gt;
<span class="gu">##</span> 1 Difficultés en lettres et sciences             1334
<span class="gu">##</span> 2 Difficultés surtout en lettres                 1790
<span class="gu">##</span> 3 Difficultés surtout en sciences                1678
<span class="gu">##</span> 4 Facilités en lettres, difficultés en sciences  1334
<span class="gu">##</span> 5 Facilités en sciences et en lettres             259
<span class="gu">##</span> 6 Facilités en sciences, difficultés en lettres  1337
<span class="gu">##</span> 7 Résultats irréguliers                          2268
</code></pre></div>

<p>C'est tout pour aujourd'hui! On espère que cette note vous permettra de mieux exploiter la puissance de ces deux petits verbes bien pratiques. Si vous avez besoin de <a href="https://statoscop.fr">conseils en programmation pour l'analyse de données</a>, n'hésitez pas à continuer votre navigation sur notre site ou à nous suivre sur <a href="https://bsky.app/profile/statoscop.fr">BlueSky</a> et <a href="https://www.linkedin.com/company/statoscop">Linkedin</a>. Pour retrouver l'ensemble du code ayant servi à générer cette note, vous pouvez vous rendre sur le <a href="https://github.com/Statoscop/notebooks-blog">github de Statoscop</a>.  </p>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br>  </p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=if_any et if_all : appliquer la même condition sur plusieurs variables dans dplyr&amp;url=https://blog.statoscop.fr/if_any-et-if_all-appliquer-la-meme-condition-sur-plusieurs-variables-dans-dplyr.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://blog.statoscop.fr/tag/r.html">R</a><a href="https://blog.statoscop.fr/tag/dplyr.html">dplyr</a><a href="https://blog.statoscop.fr/tag/tidyverse.html">tidyverse</a><a href="https://blog.statoscop.fr/tag/if_any.html">if_any</a><a href="https://blog.statoscop.fr/tag/if_all.html">if_all</a><a href="https://blog.statoscop.fr/tag/across.html">across</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
    
    <!-- Footer-->
    <footer class="footer py-4">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-4 text-lg-left"> © Statoscop</div>
                <div class="col-lg-4 my-3 my-lg-0">
                    <a class="btn btn-dark btn-social mx-2" href="https://twitter.com/stato_scop" target="_blank"><i class="fab fa-twitter"></i></a>
                </div>
                <div class="col-lg-4 text-lg-left"> 
                    Blog publié avec <a class="js-scroll-trigger text-info" href="https://docs.getpelican.com/en/latest/"  target="_blank">Pelican</a> et
                     déployé sur <a class="js-scroll-trigger text-info" href="https://pages.github.com/"  target="_blank">Github Pages</a>.
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script type="text/javascript" src="https://blog.statoscop.fr/themes/statoscop/static/js/script.js"></script>

  </body>
</html>
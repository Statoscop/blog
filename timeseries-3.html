<!DOCTYPE html>
<html lang="fr">

<head>
<title>Les séries temporelles avec Python (3/4) - Éléments théoriques et exemples</title>    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="Statisticiens à Toulouse et Bayonne organisés en coopérative pour vous accompagner dans l'analyse de vos données" />
  <meta name="author" content="" />

  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />



  <!-- <title>Le blog de Statoscop - études de cas en R et Python</title> -->
  <link rel="icon" type="image/x-icon" href="https://blog.statoscop.fr/themes/statoscop/static/images/favicon-v1.ico" />


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://blog.statoscop.fr/timeseries-3.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://blog.statoscop.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Full Atom Feed" />
          <link href="https://blog.statoscop.fr/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Categories Atom Feed" />

  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style.css" type="text/css" rel="stylesheet" />-->
  <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style-site.css" type="text/css" rel="stylesheet" /> 
  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style_fusion.css" type="text/css" rel="stylesheet" /> -->
  <!-- Code highlight color scheme -->
      <link href="https://blog.statoscop.fr/themes/statoscop/static/css/code_blocks/github.css" rel="stylesheet">

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!-- [if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  ![endif] -->



    <meta name="description" content="Éléments théoriques généraux sur les séries temporelles et quelques exemples classiques.">

    <meta name="author" content="Louis">

    <meta name="tags" content="Python">
    <meta name="tags" content="Machine Learning">
    <meta name="tags" content="Statistiques">
    <meta name="tags" content="Data Science">
    <meta name="tags" content="Séries temporelles">
    <meta name="tags" content="Datetime">




<!-- Open Graph -->
<meta property="og:site_name" content="Le blog"/>
<meta property="og:title" content="Les séries temporelles avec Python (3/4) - Éléments théoriques et exemples"/>
<meta property="og:description" content="Éléments théoriques généraux sur les séries temporelles et quelques exemples classiques."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://blog.statoscop.fr/timeseries-3.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-06-10 00:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://blog.statoscop.fr/author/louis.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="Python"/>
<meta property="article:tag" content="Machine Learning"/>
<meta property="article:tag" content="Statistiques"/>
<meta property="article:tag" content="Data Science"/>
<meta property="article:tag" content="Séries temporelles"/>
<meta property="article:tag" content="Datetime"/>
<meta property="og:image" content="https://blog.statoscop.fr/images/cover_6.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Les séries temporelles avec Python (3/4) - Éléments théoriques et exemples",
  "headline": "Les séries temporelles avec Python (3/4) - Éléments théoriques et exemples",
  "datePublished": "2021-06-10 00:00:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Louis",
    "url": "https://blog.statoscop.fr/author/louis.html"
  },
  "image": "https://blog.statoscop.fr/images/cover_6.png",
  "url": "https://blog.statoscop.fr/timeseries-3.html",
  "description": "Éléments théoriques généraux sur les séries temporelles et quelques exemples classiques."
}
</script>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//matomo.statoscop.fr/matomo/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  

</head>
<!-- TODO : Body class -->
  <body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">

        <a class="navbar-brand" href="https://statoscop.fr"><img src="https://blog.statoscop.fr/themes/statoscop/static/images/logo-statoscop-v1.png" alt="Statoscop.logo"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav text-uppercase ml-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle font-weight-bold "
                    href="https://statoscop.fr" id="navbarDropdownMenuLink" aria-haspopup="true" aria-expanded="false"> Accueil </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <li><a class="dropdown-item" href="https://statoscop.fr#services">Vos besoins</a></li>
                        <li><a class="dropdown-item" href="https://statoscop.fr#portfolio">Nos missions</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle font-weight-bold "
                    href="https://statoscop.fr/about" id="navbarDropdownMenuLink" aria-haspopup="true" aria-expanded="false"> Qui sommes-nous&#8239;? </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <li><a class="dropdown-item" href="https://statoscop.fr/about#coop">La coopérative</a></li>
                        <li><a class="dropdown-item" href="https://statoscop.fr/about#expertise">Notre expertise</a></li>
                        <li><a class="dropdown-item" href="https://statoscop.fr/about#team">L'équipe</a></li>
                    </ul>
                </li>
                <li class="nav-item font-weight-bold"><a class="nav-link js-scroll-trigger " href="https://statoscop.fr/contact">Contact</a></li>
                <li class="nav-item font-weight-bold"><a class="nav-link js-scroll-trigger active" href="https://blog.statoscop.fr/">Le blog</a></li>
            </ul>
        </div>
      </div>
    </nav>
    


    <!-- Post content -->
    <main class="content" role="main">
      
      <div>
      </div>

      <article class="post">
        <div class="inner">




            <section class="post-content">
              <h1 class="post-title">Les séries temporelles avec Python (3/4) - Éléments théoriques et exemples</h1>
                <!-- Le titres et meta infos-->
                <span class="post-meta">
                        <a href="https://blog.statoscop.fr/author/louis.html">Louis</a>
                    | <time datetime="jeu. 10 juin 2021">jeu. 10 juin 2021</time>
                </span>

                <!--Table des matieres
-->
                
                <div class="toc"><span class="toctitle">Table des matières</span><ul>
<li><a href="#notions-de-bases">Notions de bases</a><ul>
<li><a href="#definition">Définition</a></li>
<li><a href="#les-composantes-dune-serie-temporelle">Les composantes d'une série temporelle</a></li>
<li><a href="#la-stationnarite">La stationnarité</a></li>
<li><a href="#lautocorrelation-et-lautocorrelation-partielle">L'autocorrélation et l'autocorrélation partielle</a></li>
<li><a href="#bruit-blanc">Bruit blanc</a></li>
<li><a href="#la-marche-aleatoire">La marche aléatoire</a></li>
<li><a href="#modele-autoregressif">Modèle autorégressif</a></li>
<li><a href="#modele-moyenne-mobile">Modèle moyenne mobile</a></li>
<li><a href="#modele-autoregressif-et-moyenne-mobile">Modèle autorégressif et moyenne mobile</a></li>
</ul>
</li>
<li><a href="#des-exemples-de-series-temporelles">Des exemples de séries temporelles</a><ul>
<li><a href="#des-taches-solaires">Des tâches solaires</a></li>
<li><a href="#des-americains">Des américains</a></li>
<li><a href="#de-la-biere-australienne">De la bière australienne</a></li>
</ul>
</li>
</ul>
</div>
<blockquote>
<ol>
<li>Introduction à la manipulation de données temporelles avec Python</li>
<li>Visualisation et opérations sur les séries temporelles</li>
<li><strong>Éléments théoriques et exemples</strong></li>
<li>Analyse, modélisation et prédiction</li>
</ol>
</blockquote>
<p>Dans ce troisième post, nous entrons dans le coeur du sujet avec l'introduction des notions fondamentales des séries temporelles puis nous illustrerons ces concepts par quelques "vraies" séries de données.</p>
<h1 id="notions-de-bases">Notions de bases</h1>
<h2 id="definition">Définition</h2>
<p>Une série temporelle (ou chronologique), est une suite de valeurs numériques représentant l’évolution d’une quantité au cours du temps. On la note généralement <span class="math">\(\{y_t\}_{t=1}^{T}\)</span> c'est-à-dire l'ensemble des <span class="math">\(T\)</span> valeurs <span class="math">\(y_1, y_2, y_3,..., y_{T-1}, y_T\)</span>.  </p>
<p>On rencontre parfois les termes "processus" ou "processus stochastique". Cela fait référence au mécanisme, <strong>inconnu et non observable</strong>, qui a entraîné ces observations.</p>
<h2 id="les-composantes-dune-serie-temporelle">Les composantes d'une série temporelle</h2>
<p>Une série temporelle peut se décomposer en 4 composantes :<br>
- <strong>Tendance</strong> : orientation générale de la série (vers le haut ou vers le bas)<br>
- <strong>Saisonnalité</strong> : tendances hebdomadaires, mensuelles, trismestrielles ou annuelles<br>
- <strong>Cycle</strong> : cycles économiques à long terme, sur plusieurs années<br>
- <strong>Bruit</strong> : ce qui reste après avoir extrait les composants précédents  </p>
<h2 id="la-stationnarite">La stationnarité</h2>
<p>Un processus <span class="math">\(\{y_t\}_{t=1}^{T}\)</span> est dit stationnaire lorsque :  </p>
<blockquote>
<ul>
<li><span class="math">\(E(y_t) = \mu\)</span>  </li>
<li><span class="math">\(V(y_t) = \sigma²\)</span>  </li>
<li><span class="math">\(\gamma(t,s) = \gamma(t-s)\)</span> où <span class="math">\(\gamma\)</span> est la fonction d'autocorrélation qu'on va découvrir de suite  </li>
</ul>
</blockquote>
<p>Ok c'est joli les formules, mais concrètement ça veut dire quoi qu'une série est stationnaire ?</p>
<p>Premièrement, la moyenne de la série est constante et ne dépend donc pas du temps. La courbe rouge ci-dessous n'est dès lors pas stationnaire puisque sa moyenne augmente en fonction du temps</p>
<p><img src='../images/SeriesTemp3/station1.png' width=700></p>
<p>Deuxièmement, la variance de la série est constante et ne dépend donc pas du temps. On parle <strong>d'homoscédasticité</strong>. La courbe rouge ci-dessous n'est dès lors pas stationnaire puisque l'écart des points à leur moyenne (représentée par la droite bleue) varie au cours du temps.</p>
<p><img src='../images/SeriesTemp3/station2.png' width=700></p>
<p>Troisièmement, la covariance entre 2 points ne dépend pas du temps mais uniquement de l'écart entre ces points. La courbe rouge ci-dessous n'est dès lors pas stationnaire puisque l'espacement entre les points varie au cours du temps (ceux du milieu sont beaucoup plus proches entre eux que ceux aux extremités).</p>
<p><img src='../images/SeriesTemp3/station3.png' width=700></p>
<h2 id="lautocorrelation-et-lautocorrelation-partielle">L'autocorrélation et l'autocorrélation partielle</h2>
<p>L'autocorrélation est un indicateur montrant comment les observations d'une série temporelle sont liées entre elles. Il s'agit de la corrélation entre la série et cette même série décalée dans le temps :
</p>
<div class="math">$$\gamma(t,s) = \frac{1}{\sigma²} Cov(y_t,y_s) = \frac{1}{\sigma²} E[(y_t-\mu)(y_s-\mu)]$$</div>
<p>Une autre notation qui peut paraître plus claire et qui fait justement intervenir le décalage <span class="math">\(k\)</span> considéré entre les 2 séries <span class="math">\(\{y\}\)</span> :
</p>
<div class="math">$$\gamma(k) = \frac{1}{\sigma²} Cov(y_t,y_{t+k}) = \frac{1}{\sigma²} E[(y_t-\mu)(y_{t+k}-\mu)]$$</div>
<p>Si on ne normalise pas par <span class="math">\(\sigma²\)</span> on retrouve l'autocovariance. Dans le cadre des séries temporelles (et plus largement du traitement du signal) on utilise un peu indistinctement les 2 termes.</p>
<p>Comme la corrélation, l'autocorrélation prend ses valeurs entre <span class="math">\([-1,1]\)</span>. Une valeur de <span class="math">\(1\)</span> signifie que la série et la série décalée se superposent parfaitement.</p>
<p>La <strong>fonction d'autocorrélation (ACF)</strong> et la <strong>fonction d'autocorrélation partielle (PACF)</strong> permettent de mesurer l'association entre des valeurs actuelles et passées. Elles indiquent les valeurs passées les plus corrélées aux valeurs suivantes et donc les plus utiles à la prévision de valeurs futures. Pour parler <em>"avec les mains"</em>, la fonction ACF mesure la similitude entre 2 observations en fonction du décalage temporel entre les 2.</p>
<p>Concrètement :<br>
- ACF au décalage k = corrélation entre les valeurs séparées par k intervalles<br>
- PACF au décalage k = corrélation entre les valeurs séparées par k intervalles, compte tenu des valeurs des intervalles intermédiaires  </p>
<p><img src='../images/SeriesTemp3/acf_pacf.png'></p>
<p>Ces graphiques, qui répondent au doux nom de corrélogramme, interviennent dans la détermination de l'ordre des processus d'un modèle ARIMA qu'on ne présente plus mais qu'on aura l'occasion de croiser prochainement c'est promis.</p>
<h2 id="bruit-blanc">Bruit blanc</h2>
<p>Un <strong>bruit blanc</strong> est un processus <span class="math">\(\{\epsilon_t\}_{t=1}^{T}\)</span> qui vérifie :  </p>
<blockquote>
<ul>
<li><span class="math">\(E[\epsilon_t] = 0\)</span>  </li>
<li><span class="math">\(E[\epsilon_t²] = \sigma²\)</span>  </li>
<li><span class="math">\(E[\epsilon_t\epsilon_s] = 0\)</span> pour <span class="math">\(s \neq t\)</span>  </li>
</ul>
</blockquote>
<p>C'est donc une série de moyenne constante et nulle, de variance constante et de covariance nulle entre 2 observations (indépendamment du décalage entre les 2). Ce dernier point signifie donc que les observations sont <strong>non corrélées</strong> entre elles.</p>
<p>Un <strong>bruit blanc indépendant</strong> est un processus <span class="math">\(\{\epsilon_t\}_{t=1}^{T}\)</span> qui vérifie :  </p>
<blockquote>
<ul>
<li><span class="math">\(E[\epsilon_t] = 0\)</span>  </li>
<li><span class="math">\(E[\epsilon_t²] = \sigma²\)</span>  </li>
<li><span class="math">\(\epsilon_t\)</span> et <span class="math">\(\epsilon_s\)</span> indépendants pour <span class="math">\(s \neq t\)</span>  </li>
</ul>
</blockquote>
<p>Les deux premières hypothèses sont identiques. En revanche, la 3ème hypothèse est plus forte puisque l'indépendance implique que la covariance soit nulle mais la réciproque n'est pas vraie (<a href="https://fr.wikipedia.org/wiki/Ind%C3%A9pendance_(probabilit%C3%A9s)#Ind%C3%A9pendance_et_corr%C3%A9lation" target="_blank">Maître Wiki</a>) vous fournira un contre-exemple avec des variables aléatoires discrètes ; un autre contre-exemple classique avec des variables aléatoires continues <span class="math">\(X \hookrightarrow \mathcal{N}(0,1)\)</span> et <span class="math">\(Y=X²\)</span> sont dépendantes et de covariance nulle).  </p>
<p>Un <strong>bruit blanc gaussien</strong> <span class="math">\(\{\epsilon_t\}_{t=1}^{T}\)</span> est un bruit blanc indépendant qui suit une loi normale centrée : <span class="math">\(\epsilon_t \hookrightarrow \mathcal{N}(0,\sigma²)\)</span>  </p>
<p>On ajoute donc une hypothèse supplémentaire sur la distribution qui doit être une loi normale de moyenne nulle.</p>
<p>Intuitivement, un bruit blanc dans le cadre des séries temporelles, c'est <strong>la partie purement aléatoire du processus</strong>. Effectivement, j'imagine bien ce que vous pensez et vous avez tout à fait raison, les bruits blancs sont des séries stationnaires (moyenne, variance et covariance constantes).</p>
<p>Dans les lignes de code ci-dessous, on génère un bruit blanc gaussien qu'on visualise ensuite en utilisant la fonction <code>ts_plot</code> qui est disponible sur le github de Statoscop, <a href="https://github.com/Statoscop/notebooks-blog/blob/main/Series%20temporelles/fonctions.py" target="_blank">ici précisément</a> dans le fichier <code>fonction.py</code> du dossier Séries Temporelles.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">fonctions</span> <span class="k">as</span> <span class="nn">fct</span>
<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_3_0.png"></p>
<p><strong>Interprétation :</strong> les graphiques ci-dessus ressemblent à la structure souhaitée d'une série chronologique d'erreurs :<br>
- pas de pics dans les graphes ACF et PACF <br>
- le QQ-plot et l'histogramme indiquent un comportement normal  </p>
<p>Petite parenthèse, on essaiera de faire prochainement un post sur la normalité des résidus, l'interprétation des QQ-plot ou encore les différents tests de normalité.</p>
<h2 id="la-marche-aleatoire">La marche aléatoire</h2>
<p>Un processus de marche aléatoire <span class="math">\(\{x_t\}_{t=1}^{T}\)</span> est une série qui vérifie :<br>
</p>
<div class="math">$$x_t = x_{t-1} + \epsilon_t$$</div>
<p>
avec <span class="math">\(\epsilon_t\)</span> un bruit blanc</p>
<p>Ci-dessous, on simule et visualise une marche aléatoire.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#paramètres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_5_0.png"></p>
<p><strong>Interprétation :</strong> on voit la ressemblance entre ce processus de marche aléatoire et les cours d'actifs en bourse qui sont caractérisés par : <br>
- un ACF élevé pour toute longueur de décalage et un PACF élevé pour le premier décalage uniquement <br>
- un QQ-plot et un histogramme indiquant que la série n'est pas un bruit blanc  </p>
<p>La marche aléatoire n'est clairement pas une série stationnaire. Par contre, la série différenciée <span class="math">\((x_t - x_{t-1})\)</span> est stationnaire puisqu'elle vaut <span class="math">\((\epsilon_t)\)</span> qui est un bruit blanc. </p>
<h2 id="modele-autoregressif">Modèle autorégressif</h2>
<p>Une série temporelle <span class="math">\(\{x_t\}_{t=1}^{T}\)</span> qui suit un modèle autorégressif d'ordre <span class="math">\(p\)</span> (et noté <span class="math">\(AR(p)\)</span>) est telle que :<br>
</p>
<div class="math">$$x_t = \mu + \Sigma_{i=1}^{p}\phi_i x_{t-i} + \epsilon_t$$</div>
<p>
avec <span class="math">\(\mu\)</span> une constante et <span class="math">\(\epsilon_t\)</span> un bruit blanc</p>
<p>Concrètement, cela signifie que la valeur de la série au temps <span class="math">\(t\)</span> est une combinaison linéaire des <span class="math">\(p\)</span> valeurs précédentes (à un terme d'erreur <span class="math">\(\epsilon_t\)</span> près).</p>
<p>Un processus autorégressif d'ordre 1 est donc donné par :
<span class="math">\(AR(1)\)</span> : <span class="math">\(x_t = \mu + \phi x_{t-1} + \epsilon_t\)</span> </p>
<p>On simule et visualise un processus <span class="math">\(AR(1)\)</span> ci-dessous.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#paramètres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_7_0.png"></p>
<p><strong>Interprétation :</strong><br>
- pour un processus AR(1) avec <span class="math">\(\phi=0.3\)</span>,on voit sur les graphiques ACF et PACF, un pic au premier décalage qui tend tout de suite vers 0.<br>
- l'histogramme et le QQ-plot indiquent des résidus presque aléatoires.  </p>
<p><em>Remarque pas anodine</em> : la marche aléatoire introduite précédemment est un processus AR(1) avec <span class="math">\(\phi=1\)</span> et n'est pas stationnaire. Or ici, on peut voir qu'avec <span class="math">\(\phi=0.3\)</span>, le processus AR(1) semble stationnaire. Bizarre...vous avez dit bizarre ? En fait, la stationnarité d'un processus <span class="math">\(AR(1)\)</span> dépend de si <span class="math">\(|\phi|&lt;1\)</span>. On peut généraliser cette propriété aux processus <span class="math">\(AR(p)\)</span>.</p>
<h2 id="modele-moyenne-mobile">Modèle moyenne mobile</h2>
<p>Le modèle de moyenne mobile d'ordre <span class="math">\(q\)</span> noté <span class="math">\(MA(q)\)</span> (pour <em>moving-average</em>) suppose que la série temporelle observée peut être représentée par une combinaison linéaire de termes d'erreur de bruit blanc. Cela s'écrit donc :<br>
</p>
<div class="math">$$x_t = \epsilon_t + \Sigma_{i=1}^{q}\theta_i\epsilon_{t-i}$$</div>
<p> avec <span class="math">\(\epsilon_t\)</span> un bruit blanc</p>
<p>Et c'est parti pour la simulation et la visualisation d'un processus <span class="math">\(MA(2)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#paramètres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.4</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta1</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_9_0.png"></p>
<p><strong>Interprétation :</strong> pour le processus <span class="math">\(MA(2)\)</span> avec les paramètres choisis, on voit un pic plus important pour le deuxième décalage dans les tracés ACF et PACF. 
On peut observer également que le pic dans le graphique PACF ne décroît pas immédiatement mais prend quelques périodes pour se "désintégrer".</p>
<p><em>Remarque toujours pas anodine</em> : en tant que combinaison linéaire de processus stationnaires, un processus <span class="math">\(MA(q)\)</span> est toujours stationnaire.</p>
<h2 id="modele-autoregressif-et-moyenne-mobile">Modèle autorégressif et moyenne mobile</h2>
<p>Ça va commencer à se corser un peu avec le processus <span class="math">\(ARMA(p,q)\)</span> qui est une combinaison des deux modèles précédents et s'écrit donc :<br>
</p>
<div class="math">$$x_t = \epsilon_t + \Sigma_{i=1}^{p}\phi_i x_{t-i} + \Sigma_{i=1}^{q}\theta_i\epsilon_{t-i}$$</div>
<p>
avec <span class="math">\(\epsilon_t\)</span> un bruit blanc</p>
<p>Regardons à quoi ressemble un <span class="math">\(ARMA(2,3)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#paramètres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">phi1</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">phi2</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.1</span>
<span class="n">theta3</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta1</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta3</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_11_0.png"></p>
<p><strong>Interprétation :</strong> on voit clairement que la série n'est pas stationnaire et que les résidus ont l'air de suivre une loi normale mais on n'ira pas plus loin pour l'interprétation...</p>
<p>Maintenant qu'on a fait un bon petit tour d'horizon théoriques des propriétés des séries temporelles, allons en voir des vraies dans leur milieu naturel !</p>
<h1 id="des-exemples-de-series-temporelles">Des exemples de séries temporelles</h1>
<p>On va simplement regarder quelques séries temporelles et les commenter graphiquement.</p>
<h2 id="des-taches-solaires">Des tâches solaires</h2>
<p>La série "sunspot" ci-dessous recense le nombre annuel de <a href="https://fr.wikipedia.org/wiki/Tache_solaire" target="_blank">tâches solaires</a> de 1790 à 1970.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">sunspot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sunspot.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">sunspot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;sunspot&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_15_0.png"></p>
<p>Quelques remarques :<br>
- cette série n'est clairement pas stationnaire<br>
- il ne semble pas y avoir de saisonnalité<br>
- par contre, elle semble présenter des cycles avec un pic plus ou moins tous les 10 ans dont l'amplitude semble légèrement augmenter au cours du temps<br>
- cette série ne semble pas très bruitée (c'est-à-dire qu'il n'y a pas une forte variabilité d'un point à l'autre qui se traduirait par des pics très rapprochés comme pour les séries d'actifs financiers par exemple). Attention toutefois, avant de conclure là-dessus il faut s'assurer de la fréquence de la série (annuelle).  </p>
<h2 id="des-americains">Des américains</h2>
<p>La série "uspop" ci-dessous recense la population des Etats-Unis, en millions, de 1790 à 1990 (avec une fréquence décennale).</p>
<div class="highlight"><pre><span></span><code><span class="n">uspop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/uspop.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">uspop</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;uspop&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_17_0.png"></p>
<p>Quelques remarques :<br>
- cette série n'est pas stationnaire<br>
- cette série est très lisse puisqu'elle ne présente ni saisonnalité, ni cycle, ni bruit<br>
- on identifie donc uniquement une tendance  </p>
<h2 id="de-la-biere-australienne">De la bière australienne</h2>
<p>La série "beer" ci-dessous mesure la production mensuelle de bière en Australie, en mégalitres, de janvier 1956 à août 1995.</p>
<div class="highlight"><pre><span></span><code><span class="n">beer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/beer.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;Beer&quot;</span><span class="p">],</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">beer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;Beer&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_19_0.png"></p>
<p>Quelques remarques :<br>
- cette série n'est pas stationnaire<br>
- il y a une tendance à la hausse jusqu'à la fin des années 70 puis une légère baisse et une stabilisation<br>
- il ne semble pas y avoir de cycles<br>
- en revanche, il y a bien une saisonnalité avec un "motif" annuel qui se répète contenant un pic haut (parfois un 2ème identifiable) et un creux  </p>
<p>Voilà quelques exemples d'analyse graphique, et rapide, de séries temporelles. Comme toujours, le code ayant généré ce notebook est disponible sur le <a href="https://github.com/Statoscop/notebooks-blog" target="_blank">github de Statoscop</a>. Maintenant, la question est de savoir comment on va pouvoir identifier les différents éléments composant une série avant de s'intéresser à leur modélisation et leur prédiction. Alors, impatients de savoir comment décomposer une série temporelle ? La suite dans le prochain post !</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Les séries temporelles avec Python (3/4) - Éléments théoriques et exemples&amp;url=https://blog.statoscop.fr/timeseries-3.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://blog.statoscop.fr/tag/python.html">Python</a><a href="https://blog.statoscop.fr/tag/machine-learning.html">Machine Learning</a><a href="https://blog.statoscop.fr/tag/statistiques.html">Statistiques</a><a href="https://blog.statoscop.fr/tag/data-science.html">Data Science</a><a href="https://blog.statoscop.fr/tag/series-temporelles.html">Séries temporelles</a><a href="https://blog.statoscop.fr/tag/datetime.html">Datetime</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
    
    <!-- Footer-->
    <footer class="footer py-4">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-4 text-lg-left"> © Statoscop</div>
                <div class="col-lg-4 my-3 my-lg-0">
                    <a class="btn btn-dark btn-social mx-2" href="https://twitter.com/stato_scop" target="_blank"><i class="fab fa-twitter"></i></a>
                </div>
                <div class="col-lg-4 text-lg-left"> 
                    Blog publié avec <a class="js-scroll-trigger text-info" href="https://docs.getpelican.com/en/latest/"  target="_blank">Pelican</a> et
                     déployé sur <a class="js-scroll-trigger text-info" href="https://pages.github.com/"  target="_blank">Github Pages</a>.
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script type="text/javascript" src="https://blog.statoscop.fr/themes/statoscop/static/js/script.js"></script>

  </body>
</html>
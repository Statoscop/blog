<!DOCTYPE html>
<html lang="fr">

<head>
<title>Les s√©ries temporelles avec Python (3/4) - √âl√©ments th√©oriques et exemples</title>    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="Le blog statistiques et data science de la coop√©rative Statoscop" />
  <meta name="author" content="" />

  <!-- Font Awesome icons (free version)-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />



  <!-- <title>Le blog de Statoscop - √©tudes de cas en R et Python</title> -->
  <link rel="icon" type="image/x-icon" href="https://blog.statoscop.fr/themes/statoscop/static/images/favicon-v1.ico" />


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://blog.statoscop.fr/timeseries-3.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://blog.statoscop.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Full Atom Feed" />
          <link href="https://blog.statoscop.fr/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Categories Atom Feed" />

  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style.css" type="text/css" rel="stylesheet" />-->
  <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style-site.css" type="text/css" rel="stylesheet" /> 
  <!-- <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style_fusion.css" type="text/css" rel="stylesheet" /> -->
  <!-- Code highlight color scheme -->
      <link href="https://blog.statoscop.fr/themes/statoscop/static/css/code_blocks/github.css" rel="stylesheet">

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!-- [if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  ![endif] -->



    <meta name="description" content="√âl√©ments th√©oriques g√©n√©raux sur les s√©ries temporelles et quelques exemples classiques.">

    <meta name="author" content="Louis">

    <meta name="tags" content="Python">
    <meta name="tags" content="Machine Learning">
    <meta name="tags" content="Statistiques">
    <meta name="tags" content="Data Science">
    <meta name="tags" content="S√©ries temporelles">
    <meta name="tags" content="Datetime">




<!-- Open Graph -->
<meta property="og:site_name" content="Le blog"/>
<meta property="og:title" content="Les s√©ries temporelles avec Python (3/4) - √âl√©ments th√©oriques et exemples"/>
<meta property="og:description" content="√âl√©ments th√©oriques g√©n√©raux sur les s√©ries temporelles et quelques exemples classiques."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://blog.statoscop.fr/timeseries-3.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-06-10 00:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://blog.statoscop.fr/author/louis.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="Python"/>
<meta property="article:tag" content="Machine Learning"/>
<meta property="article:tag" content="Statistiques"/>
<meta property="article:tag" content="Data Science"/>
<meta property="article:tag" content="S√©ries temporelles"/>
<meta property="article:tag" content="Datetime"/>
<meta property="og:image" content="https://blog.statoscop.fr/images/cover_6.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Les s√©ries temporelles avec Python (3/4) - √âl√©ments th√©oriques et exemples",
  "headline": "Les s√©ries temporelles avec Python (3/4) - √âl√©ments th√©oriques et exemples",
  "datePublished": "2021-06-10 00:00:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Louis",
    "url": "https://blog.statoscop.fr/author/louis.html"
  },
  "image": "https://blog.statoscop.fr/images/cover_6.png",
  "url": "https://blog.statoscop.fr/timeseries-3.html",
  "description": "√âl√©ments th√©oriques g√©n√©raux sur les s√©ries temporelles et quelques exemples classiques."
}
</script>
  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//matomo.statoscop.fr/matomo/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  

</head>
<!-- TODO : Body class -->
  <body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">

        <a class="navbar-brand" href="https://statoscop.fr"><img src="https://blog.statoscop.fr/themes/statoscop/static/images/logo-statoscop-v1.png" alt="Statoscop.logo"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr"> Accueil </a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/about"> √Ä propos </a>
              </li>
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle font-weight-bold "
                  id="navbarDropdownMenuLink" aria-haspopup="true" aria-expanded="false"> Prestations </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      <li><a class="dropdown-item" href="https://statoscop.fr/etudes">Conseils & √©tudes statistiques</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/recodages">Migrations de code & Recodages</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/formations">Formations</a></li>
                      <li><a class="dropdown-item" href="https://statoscop.fr/applis">Dashboards & Applications</a></li>
                  </ul>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger " href="https://statoscop.fr/contact">Contact</a>
              </li>
              <li class="nav-item font-weight-bold">
                  <a class="nav-link js-scroll-trigger active" href="https://blog.statoscop.fr/">Le blog</a>
              </li>
          </ul>
      </div>
      </div>
    </nav>
    


    <!-- Post content -->
    <main class="content" role="main">
      
      <div>
      </div>

      <article class="post">
        <div class="inner">




            <section class="post-content">
              <h1 class="post-title">Les s√©ries temporelles avec Python (3/4) - √âl√©ments th√©oriques et exemples</h1>
                <!-- Le titres et meta infos-->
                <span class="post-meta">
                        <a href="https://blog.statoscop.fr/author/louis.html">Louis</a>
                    | <time datetime="jeu. 10 juin 2021">jeu. 10 juin 2021</time>
                </span>

                <!--Table des matieres
-->
                
                <div class="toc"><span class="toctitle">Dans cet article</span><ul>
<li><a href="#notions-de-bases">Notions de bases</a><ul>
<li><a href="#definition">D√©finition</a></li>
<li><a href="#les-composantes-dune-serie-temporelle">Les composantes d'une s√©rie temporelle</a></li>
<li><a href="#la-stationnarite">La stationnarit√©</a></li>
<li><a href="#lautocorrelation-et-lautocorrelation-partielle">L'autocorr√©lation et l'autocorr√©lation partielle</a></li>
<li><a href="#bruit-blanc">Bruit blanc</a></li>
<li><a href="#la-marche-aleatoire">La marche al√©atoire</a></li>
<li><a href="#modele-autoregressif">Mod√®le autor√©gressif</a></li>
<li><a href="#modele-moyenne-mobile">Mod√®le moyenne mobile</a></li>
<li><a href="#modele-autoregressif-et-moyenne-mobile">Mod√®le autor√©gressif et moyenne mobile</a></li>
</ul>
</li>
<li><a href="#des-exemples-de-series-temporelles">Des exemples de s√©ries temporelles</a><ul>
<li><a href="#des-taches-solaires">Des t√¢ches solaires</a></li>
<li><a href="#des-americains">Des am√©ricains</a></li>
<li><a href="#de-la-biere-australienne">De la bi√®re australienne</a></li>
</ul>
</li>
</ul>
</div>
<blockquote>
<ol>
<li>Introduction √† la manipulation de donn√©es temporelles avec Python</li>
<li>Visualisation et op√©rations sur les s√©ries temporelles</li>
<li><strong>√âl√©ments th√©oriques et exemples</strong></li>
<li>Analyse, mod√©lisation et pr√©diction</li>
</ol>
</blockquote>
<p>Dans ce troisi√®me post, nous entrons dans le coeur du sujet avec l'introduction des notions fondamentales des s√©ries temporelles puis nous illustrerons ces concepts par quelques "vraies" s√©ries de donn√©es.</p>
<h1 id="notions-de-bases">Notions de bases</h1>
<h2 id="definition">D√©finition</h2>
<p>Une s√©rie temporelle (ou chronologique), est une suite de valeurs num√©riques repr√©sentant l‚Äô√©volution d‚Äôune quantit√© au cours du temps. On la note g√©n√©ralement ${y_t}<em T-1>{t=1}^{T}$ c'est-√†-dire l'ensemble des $T$ valeurs $y_1, y_2, y_3,..., y</em>, y_T$.  </p>
<p>On rencontre parfois les termes "processus" ou "processus stochastique". Cela fait r√©f√©rence au m√©canisme, <strong>inconnu et non observable</strong>, qui a entra√Æn√© ces observations.</p>
<h2 id="les-composantes-dune-serie-temporelle">Les composantes d'une s√©rie temporelle</h2>
<p>Une s√©rie temporelle peut se d√©composer en 4 composantes :<br>
- <strong>Tendance</strong> : orientation g√©n√©rale de la s√©rie (vers le haut ou vers le bas)<br>
- <strong>Saisonnalit√©</strong> : tendances hebdomadaires, mensuelles, trismestrielles ou annuelles<br>
- <strong>Cycle</strong> : cycles √©conomiques √† long terme, sur plusieurs ann√©es<br>
- <strong>Bruit</strong> : ce qui reste apr√®s avoir extrait les composants pr√©c√©dents  </p>
<h2 id="la-stationnarite">La stationnarit√©</h2>
<p>Un processus ${y_t}_{t=1}^{T}$ est dit stationnaire lorsque :<br>
- $E(y_t) = \mu$<br>
- $V(y_t) = \sigma¬≤$<br>
- $\gamma(t,s) = \gamma(t-s)$ o√π $\gamma$ est la fonction d'autocorr√©lation qu'on va d√©couvrir de suite  </p>
<p>Ok c'est joli les formules, mais concr√®tement √ßa veut dire quoi qu'une s√©rie est stationnaire ?</p>
<p>Premi√®rement, la moyenne de la s√©rie est constante et ne d√©pend donc pas du temps. La courbe rouge ci-dessous n'est d√®s lors pas stationnaire puisque sa moyenne augmente en fonction du temps</p>
<p><img src='../images/SeriesTemp3/station1.png' width=700></p>
<p>Deuxi√®mement, la variance de la s√©rie est constante et ne d√©pend donc pas du temps. On parle <strong>d'homosc√©dasticit√©</strong>. La courbe rouge ci-dessous n'est d√®s lors pas stationnaire puisque l'√©cart des points √† leur moyenne (repr√©sent√©e par la droite bleue) varie au cours du temps.</p>
<p><img src='../images/SeriesTemp3/station2.png' width=700></p>
<p>Troisi√®mement, la covariance entre 2 points ne d√©pend pas du temps mais uniquement de l'√©cart entre ces points. La courbe rouge ci-dessous n'est d√®s lors pas stationnaire puisque l'espacement entre les points varie au cours du temps (ceux du milieu sont beaucoup plus proches entre eux que ceux aux extremit√©s).</p>
<p><img src='../images/SeriesTemp3/station3.png' width=700></p>
<h2 id="lautocorrelation-et-lautocorrelation-partielle">L'autocorr√©lation et l'autocorr√©lation partielle</h2>
<p>L'autocorr√©lation est un indicateur montrant comment les observations d'une s√©rie temporelle sont li√©es entre elles. Il s'agit de la corr√©lation entre la s√©rie et cette m√™me s√©rie d√©cal√©e dans le temps :
$$\gamma(t,s) = \frac{1}{\sigma¬≤} Cov(y_t,y_s) = \frac{1}{\sigma¬≤} E[(y_t-\mu)(y_s-\mu)]$$</p>
<p>Une autre notation qui peut para√Ætre plus claire et qui fait justement intervenir le d√©calage $k$ consid√©r√© entre les 2 s√©ries ${y}$ :
$$\gamma(k) = \frac{1}{\sigma¬≤} Cov(y_t,y_{t+k}) = \frac{1}{\sigma¬≤} E[(y_t-\mu)(y_{t+k}-\mu)]$$</p>
<p>Si on ne normalise pas par $\sigma¬≤$ on retrouve l'autocovariance. Dans le cadre des s√©ries temporelles (et plus largement du traitement du signal) on utilise un peu indistinctement les 2 termes.</p>
<p>Comme la corr√©lation, l'autocorr√©lation prend ses valeurs entre $[-1,1]$. Une valeur de $1$ signifie que la s√©rie et la s√©rie d√©cal√©e se superposent parfaitement.</p>
<p>La <strong>fonction d'autocorr√©lation (ACF)</strong> et la <strong>fonction d'autocorr√©lation partielle (PACF)</strong> permettent de mesurer l'association entre des valeurs actuelles et pass√©es. Elles indiquent les valeurs pass√©es les plus corr√©l√©es aux valeurs suivantes et donc les plus utiles √† la pr√©vision de valeurs futures. Pour parler <em>"avec les mains"</em>, la fonction ACF mesure la similitude entre 2 observations en fonction du d√©calage temporel entre les 2.</p>
<p>Concr√®tement :<br>
- ACF au d√©calage k = corr√©lation entre les valeurs s√©par√©es par k intervalles<br>
- PACF au d√©calage k = corr√©lation entre les valeurs s√©par√©es par k intervalles, compte tenu des valeurs des intervalles interm√©diaires  </p>
<p><img src='../images/SeriesTemp3/acf_pacf.png'></p>
<p>Ces graphiques, qui r√©pondent au doux nom de corr√©logramme, interviennent dans la d√©termination de l'ordre des processus d'un mod√®le ARIMA qu'on ne pr√©sente plus mais qu'on aura l'occasion de croiser prochainement c'est promis.</p>
<h2 id="bruit-blanc">Bruit blanc</h2>
<p>Un <strong>bruit blanc</strong> est un processus ${\epsilon_t}_{t=1}^{T}$ qui v√©rifie :<br>
- $E[\epsilon_t] = 0$<br>
- $E[\epsilon_t¬≤] = \sigma¬≤$<br>
- $E[\epsilon_t\epsilon_s] = 0$ pour $s \neq t$  </p>
<p>C'est donc une s√©rie de moyenne constante et nulle, de variance constante et de covariance nulle entre 2 observations (ind√©pendamment du d√©calage entre les 2). Ce dernier point signifie donc que les observations sont <strong>non corr√©l√©es</strong> entre elles.</p>
<p>Un <strong>bruit blanc ind√©pendant</strong> est un processus ${\epsilon_t}_{t=1}^{T}$ qui v√©rifie :<br>
- $E[\epsilon_t] = 0$<br>
- $E[\epsilon_t¬≤] = \sigma¬≤$<br>
- $\epsilon_t$ et $\epsilon_s$ ind√©pendants pour $s \neq t$  </p>
<p>Les deux premi√®res hypoth√®ses sont identiques. En revanche, la 3√®me hypoth√®se est plus forte puisque l'ind√©pendance implique que la covariance soit nulle mais la r√©ciproque n'est pas vraie (<a href="https://fr.wikipedia.org/wiki/Ind%C3%A9pendance_(probabilit%C3%A9s)#Ind%C3%A9pendance_et_corr%C3%A9lation" target="_blank">Ma√Ætre Wiki</a> vous fournira un contre-exemple avec des variables al√©atoires discr√®tes ; un autre contre-exemple classique avec des variables al√©atoires continues $X \hookrightarrow \mathcal{N}(0,1)$ et $Y=X¬≤$ sont d√©pendantes et de covariance nulle).  </p>
<p>Un <strong>bruit blanc gaussien</strong> ${\epsilon_t}_{t=1}^{T}$ est un bruit blanc ind√©pendant qui suit une loi normale centr√©e : $\epsilon_t \hookrightarrow \mathcal{N}(0,\sigma¬≤)$  </p>
<p>On ajoute donc une hypoth√®se suppl√©mentaire sur la distribution qui doit √™tre une loi normale de moyenne nulle.</p>
<p>Intuitivement, un bruit blanc dans le cadre des s√©ries temporelles, c'est <strong>la partie purement al√©atoire du processus</strong>. Effectivement, j'imagine bien ce que vous pensez et vous avez tout √† fait raison, les bruits blancs sont des s√©ries stationnaires (moyenne, variance et covariance constantes).</p>
<p>Dans les lignes de code ci-dessous, on g√©n√®re un bruit blanc gaussien qu'on visualise ensuite en utilisant la fonction <code>ts_plot</code> qui est disponible sur le github de Statoscop, <a href="https://github.com/Statoscop/notebooks-blog/blob/main/Series%20temporelles/fonctions.py" target="_blank">ici pr√©cis√©ment</a> dans le fichier <code>fonction.py</code> du dossier S√©ries Temporelles.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">fonctions</span> <span class="k">as</span> <span class="nn">fct</span>
<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_3_0.png"></p>
<p><strong>Interpr√©tation :</strong> les graphiques ci-dessus ressemblent √† la structure souhait√©e d'une s√©rie chronologique d'erreurs :<br>
- pas de pics dans les graphes ACF et PACF <br>
- le QQ-plot et l'histogramme indiquent un comportement normal  </p>
<p>Petite parenth√®se, on essaiera de faire prochainement un post sur la normalit√© des r√©sidus, l'interpr√©tation des QQ-plot ou encore les diff√©rents tests de normalit√©.</p>
<h2 id="la-marche-aleatoire">La marche al√©atoire</h2>
<p>Un processus de marche al√©atoire ${x_t}<em t-1>{t=1}^{T}$ est une s√©rie qui v√©rifie :<br>
$$x_t = x</em> + \epsilon_t$$
avec $\epsilon_t$ un bruit blanc</p>
<p>Ci-dessous, on simule et visualise une marche al√©atoire.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#param√®tres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_5_0.png"></p>
<p><strong>Interpr√©tation :</strong> on voit la ressemblance entre ce processus de marche al√©atoire et les cours d'actifs en bourse qui sont caract√©ris√©s par : <br>
- un ACF √©lev√© pour toute longueur de d√©calage et un PACF √©lev√© pour le premier d√©calage uniquement <br>
- un QQ-plot et un histogramme indiquant que la s√©rie n'est pas un bruit blanc  </p>
<p>La marche al√©atoire n'est clairement pas une s√©rie stationnaire. Par contre, la s√©rie diff√©renci√©e $(x_t - x_{t-1})$ est stationnaire puisqu'elle vaut $(\epsilon_t)$ qui est un bruit blanc. </p>
<h2 id="modele-autoregressif">Mod√®le autor√©gressif</h2>
<p>Une s√©rie temporelle ${x_t}<em i="1">{t=1}^{T}$ qui suit un mod√®le autor√©gressif d'ordre $p$ (et not√© $AR(p)$) est telle que :<br>
$$x_t = \mu + \Sigma</em> + \epsilon_t$$
avec $\mu$ une constante et $\epsilon_t$ un bruit blanc}^{p}\phi_i x_{t-i</p>
<p>Concr√®tement, cela signifie que la valeur de la s√©rie au temps $t$ est une combinaison lin√©aire des $p$ valeurs pr√©c√©dentes (√† un terme d'erreur $\epsilon_t$ pr√®s).</p>
<p>Un processus autor√©gressif d'ordre 1 est donc donn√© par :
$AR(1)$ : $x_t = \mu + \phi x_{t-1} + \epsilon_t$ </p>
<p>On simule et visualise un processus $AR(1)$ ci-dessous.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#param√®tres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_7_0.png"></p>
<p><strong>Interpr√©tation :</strong><br>
- pour un processus AR(1) avec $\phi=0.3$,on voit sur les graphiques ACF et PACF, un pic au premier d√©calage qui tend tout de suite vers 0.<br>
- l'histogramme et le QQ-plot indiquent des r√©sidus presque al√©atoires.  </p>
<p><em>Remarque pas anodine</em> : la marche al√©atoire introduite pr√©c√©demment est un processus AR(1) avec $\phi=1$ et n'est pas stationnaire. Or ici, on peut voir qu'avec $\phi=0.3$, le processus AR(1) semble stationnaire. Bizarre...vous avez dit bizarre ? En fait, la stationnarit√© d'un processus $AR(1)$ d√©pend de si $|\phi|&lt;1$. On peut g√©n√©raliser cette propri√©t√© aux processus $AR(p)$.</p>
<h2 id="modele-moyenne-mobile">Mod√®le moyenne mobile</h2>
<p>Le mod√®le de moyenne mobile d'ordre $q$ not√© $MA(q)$ (pour <em>moving-average</em>) suppose que la s√©rie temporelle observ√©e peut √™tre repr√©sent√©e par une combinaison lin√©aire de termes d'erreur de bruit blanc. Cela s'√©crit donc :<br>
$$x_t = \epsilon_t + \Sigma_{i=1}^{q}\theta_i\epsilon_{t-i}$$ avec $\epsilon_t$ un bruit blanc</p>
<p>Et c'est parti pour la simulation et la visualisation d'un processus $MA(2)$.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#param√®tres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.4</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta1</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_9_0.png"></p>
<p><strong>Interpr√©tation :</strong> pour le processus $MA(2)$ avec les param√®tres choisis, on voit un pic plus important pour le deuxi√®me d√©calage dans les trac√©s ACF et PACF. 
On peut observer √©galement que le pic dans le graphique PACF ne d√©cro√Æt pas imm√©diatement mais prend quelques p√©riodes pour se "d√©sint√©grer".</p>
<p><em>Remarque toujours pas anodine</em> : en tant que combinaison lin√©aire de processus stationnaires, un processus $MA(q)$ est toujours stationnaire.</p>
<h2 id="modele-autoregressif-et-moyenne-mobile">Mod√®le autor√©gressif et moyenne mobile</h2>
<p>√áa va commencer √† se corser un peu avec le processus $ARMA(p,q)$ qui est une combinaison des deux mod√®les pr√©c√©dents et s'√©crit donc :<br>
$$x_t = \epsilon_t + \Sigma_{i=1}^{p}\phi_i x_{t-i} + \Sigma_{i=1}^{q}\theta_i\epsilon_{t-i}$$
avec $\epsilon_t$ un bruit blanc</p>
<p>Regardons √† quoi ressemble un $ARMA(2,3)$.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#param√®tres</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">phi1</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">phi2</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.1</span>
<span class="n">theta3</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta1</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta2</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">theta3</span> <span class="o">*</span> <span class="n">e</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>

<span class="n">fct</span><span class="o">.</span><span class="n">ts_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_11_0.png"></p>
<p><strong>Interpr√©tation :</strong> on voit clairement que la s√©rie n'est pas stationnaire et que les r√©sidus ont l'air de suivre une loi normale mais on n'ira pas plus loin pour l'interpr√©tation...</p>
<p>Maintenant qu'on a fait un bon petit tour d'horizon th√©oriques des propri√©t√©s des s√©ries temporelles, allons en voir des vraies dans leur milieu naturel !  </p>
<blockquote>
<p>üëã Nous c'est Antoine et Louis de Statoscop, une coop√©rative de statisticiens / data scientists.
Vous voulez en savoir plus sur ce que l'on fait?</p>
</blockquote>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br>  </p>
<h1 id="des-exemples-de-series-temporelles">Des exemples de s√©ries temporelles</h1>
<p>On va simplement regarder quelques s√©ries temporelles et les commenter graphiquement.</p>
<h2 id="des-taches-solaires">Des t√¢ches solaires</h2>
<p>La s√©rie "sunspot" ci-dessous recense le nombre annuel de <a href="https://fr.wikipedia.org/wiki/Tache_solaire" target="_blank">t√¢ches solaires</a> de 1790 √† 1970.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">sunspot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/sunspot.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">sunspot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;sunspot&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_15_0.png"></p>
<p>Quelques remarques :<br>
- cette s√©rie n'est clairement pas stationnaire<br>
- il ne semble pas y avoir de saisonnalit√©<br>
- par contre, elle semble pr√©senter des cycles avec un pic plus ou moins tous les 10 ans dont l'amplitude semble l√©g√®rement augmenter au cours du temps<br>
- cette s√©rie ne semble pas tr√®s bruit√©e (c'est-√†-dire qu'il n'y a pas une forte variabilit√© d'un point √† l'autre qui se traduirait par des pics tr√®s rapproch√©s comme pour les s√©ries d'actifs financiers par exemple). Attention toutefois, avant de conclure l√†-dessus il faut s'assurer de la fr√©quence de la s√©rie (annuelle).  </p>
<h2 id="des-americains">Des am√©ricains</h2>
<p>La s√©rie "uspop" ci-dessous recense la population des Etats-Unis, en millions, de 1790 √† 1990 (avec une fr√©quence d√©cennale).</p>
<div class="highlight"><pre><span></span><code><span class="n">uspop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/uspop.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">uspop</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;uspop&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_17_0.png"></p>
<p>Quelques remarques :<br>
- cette s√©rie n'est pas stationnaire<br>
- cette s√©rie est tr√®s lisse puisqu'elle ne pr√©sente ni saisonnalit√©, ni cycle, ni bruit<br>
- on identifie donc uniquement une tendance  </p>
<h2 id="de-la-biere-australienne">De la bi√®re australienne</h2>
<p>La s√©rie "beer" ci-dessous mesure la production mensuelle de bi√®re en Australie, en m√©galitres, de janvier 1956 √† ao√ªt 1995.</p>
<div class="highlight"><pre><span></span><code><span class="n">beer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/beer.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;Beer&quot;</span><span class="p">],</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">beer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;Beer&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
</code></pre></div>

<p><img alt="Pelican" src="../images/SeriesTemp3/output_19_0.png"></p>
<p>Quelques remarques :<br>
- cette s√©rie n'est pas stationnaire<br>
- il y a une tendance √† la hausse jusqu'√† la fin des ann√©es 70 puis une l√©g√®re baisse et une stabilisation<br>
- il ne semble pas y avoir de cycles<br>
- en revanche, il y a bien une saisonnalit√© avec un "motif" annuel qui se r√©p√®te contenant un pic haut (parfois un 2√®me identifiable) et un creux  </p>
<p>Voil√† quelques exemples d'analyse graphique, et rapide, de s√©ries temporelles. Comme toujours, le code ayant g√©n√©r√© ce notebook est disponible sur le <a href="https://github.com/Statoscop/notebooks-blog" target="_blank">github de Statoscop</a>. Maintenant, la question est de savoir comment on va pouvoir identifier les diff√©rents √©l√©ments composant une s√©rie avant de s'int√©resser √† leur mod√©lisation et leur pr√©diction. Alors, impatients de savoir comment d√©composer une s√©rie temporelle ? La suite dans le prochain post !</p>
<div class = "d-flex justify-content-center mt-4">
   <a href="https://statoscop.fr" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Visiter notre site</a>
   <a href="https://statoscop.fr/contact" target=_blank class="btn btn-primary btn-custom text-uppercase" type="button">Nous contacter</a>
</div>
<p><br>  </p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Les s√©ries temporelles avec Python (3/4) - √âl√©ments th√©oriques et exemples&amp;url=https://blog.statoscop.fr/timeseries-3.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://blog.statoscop.fr/tag/python.html">Python</a><a href="https://blog.statoscop.fr/tag/machine-learning.html">Machine Learning</a><a href="https://blog.statoscop.fr/tag/statistiques.html">Statistiques</a><a href="https://blog.statoscop.fr/tag/data-science.html">Data Science</a><a href="https://blog.statoscop.fr/tag/series-temporelles.html">S√©ries temporelles</a><a href="https://blog.statoscop.fr/tag/datetime.html">Datetime</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
    
        <!-- Footer-->
        <footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-left"> ¬© Statoscop<br> 3 rue Jacques Roudil 31300 Toulouse</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                        <a class="btn btn-dark btn-social mx-2" href="https://fr.linkedin.com/company/statoscop" target="_blank"><i class="fa-brands fa-linkedin-in"></i></a>
                    </div>
                    <div class="col-lg-4 text-lg-left"> 
                        Blog publi√© avec <a class="js-scroll-trigger text-info" href="https://docs.getpelican.com/en/latest/"  target="_blank">Pelican</a> et
                        d√©ploy√© sur <a class="js-scroll-trigger text-info" href="https://pages.github.com/"  target="_blank">Github Pages</a>.
                    </div>
                </div>
            </div>
        </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script type="text/javascript" src="https://blog.statoscop.fr/themes/statoscop/static/js/script.js"></script>

  </body>
</html>
<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Le blog de Statoscop - études de cas en R et Python</title>
  <link rel="icon" type="image/x-icon" href="https://blog.statoscop.fr/themes/statoscop/static/images/favicon-v1.ico" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://blog.statoscop.fr/manip-donnees-pandas.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://blog.statoscop.fr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Full Atom Feed" />
          <link href="https://blog.statoscop.fr/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Le blog Categories Atom Feed" />

  <link href="https://blog.statoscop.fr/themes/statoscop/static/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://blog.statoscop.fr/themes/statoscop/static/css/code_blocks/github.css" rel="stylesheet">

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="Tour d'horizon des manières de filtrer des observations et sélectionner des colonnes avec pandas">

    <meta name="author" content="Antoine">

    <meta name="tags" content="Python">
    <meta name="tags" content="Statistiques">
    <meta name="tags" content="Data Science">
    <meta name="tags" content="index">
    <meta name="tags" content="loc">
    <meta name="tags" content="iloc">
    <meta name="tags" content="colonnes">
    <meta name="tags" content="lignes">




<!-- Open Graph -->
<meta property="og:site_name" content="Le blog"/>
<meta property="og:title" content="Manipulation de données avec pandas"/>
<meta property="og:description" content="Tour d'horizon des manières de filtrer des observations et sélectionner des colonnes avec pandas"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://blog.statoscop.fr/manip-donnees-pandas.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2022-10-12 00:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://blog.statoscop.fr/author/antoine.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="Python"/>
<meta property="article:tag" content="Statistiques"/>
<meta property="article:tag" content="Data Science"/>
<meta property="article:tag" content="index"/>
<meta property="article:tag" content="loc"/>
<meta property="article:tag" content="iloc"/>
<meta property="article:tag" content="colonnes"/>
<meta property="article:tag" content="lignes"/>
<meta property="og:image" content="https://blog.statoscop.fr/images/cover_11.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Manipulation de données avec pandas",
  "headline": "Manipulation de données avec pandas",
  "datePublished": "2022-10-12 00:00:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Antoine",
    "url": "https://blog.statoscop.fr/author/antoine.html"
  },
  "image": "https://blog.statoscop.fr/images/cover_11.png",
  "url": "https://blog.statoscop.fr/manip-donnees-pandas.html",
  "description": "Tour d'horizon des manières de filtrer des observations et sélectionner des colonnes avec pandas"
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header">
      <div class="inner">
        <nav id="navigation">
          <span class="blog-logo">
            <a href="https://statoscop.fr"><img src="https://blog.statoscop.fr/themes/statoscop/static/images/logo-statoscop-v1.png" alt="Blog Logo" /></a>
          </span>
          <span id="menu-button" class="nav-button">
            <a href="https://blog.statoscop.fr">Retour à l'accueil du blog</a>
          </span>
        </nav>
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
      
      <div>
      </div>

      <article class="post">
        <div class="inner">




            <section class="post-content">
              <h1 class="post-title">Manipulation de données avec pandas</h1>
                <!-- Le titres et meta infos-->
                <span class="post-meta">
                        <a href="https://blog.statoscop.fr/author/antoine.html">Antoine</a>
                    | <time datetime="mer. 12 octobre 2022">mer. 12 octobre 2022</time>
                </span>

                <!--Table des matieres
-->
                
                <div class="toc"><span class="toctitle">Table des matières</span><ul>
<li><a href="#manipulation-de-donnees-avec-pandas">Manipulation de données avec pandas</a><ul>
<li><a href="#filtrer-des-observations">Filtrer des observations</a><ul>
<li><a href="#a-partir-de-leur-position-avec-iloc">À partir de leur position  avec iloc</a></li>
<li><a href="#a-partir-de-leur-index-avec-loc">À partir de leur index avec loc</a></li>
<li><a href="#a-partir-de-conditions-avec-loc-et">À partir de conditions avec loc et []</a></li>
</ul>
</li>
<li><a href="#selectionner-des-variables">Sélectionner des variables</a><ul>
<li><a href="#a-partir-de-leur-position-avec-iloc_1">À partir de leur position avec iloc</a></li>
<li><a href="#a-partir-de-leur-nom-avec-loc-et">À partir de leur nom avec loc et []</a></li>
<li><a href="#a-partir-de-conditions-avec-loc">À partir de conditions avec loc</a></li>
</ul>
</li>
<li><a href="#synthese-jutilise-quoi-du-coup">Synthèse : j'utilise quoi du coup?</a><ul>
<li><a href="#iloc-ou-loc">iloc ou loc ?</a></li>
<li><a href="#ou-loc">[] ou loc?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="manipulation-de-donnees-avec-pandas">Manipulation de données avec pandas</h1>
<p>Dans cet article, on va essayer de clarifier les différentes options qui s'offrent à vous pour manipuler vos données avec Python en utilisant la librairie <code>pandas</code>. On se place dans le cas d'un tableau de données <em>tidy</em>, c'est à dire où chaque <strong>colonne</strong> représente une <strong>variable</strong>, ou caractéristique, et chaque <strong>ligne</strong> une <strong>observation</strong>. Dans ce cadre, on présente les options possibles pour :  </p>
<ul>
<li><strong>Filtrer les observations</strong>, c'est à dire conserver certaines lignes.   </li>
<li><strong>Sélectionner des variables</strong>, c'est à dire conserver certaines colonnes.     </li>
</ul>
<p>En particulier, on mettra l'accent sur les différences entre les fonctions <code>loc</code> et <code>iloc</code> et le rôle particulier des index. Pour illustrer cet article, on s'appuie sur la base de données <code>titanic</code>, <a href="https://www.kaggle.com/datasets/heptapod/titanic">disponible notamment sur Kaggle</a>. On importe la version csv de cette base avec <code>read_csv</code> et on affiche ses caractéristiques :    </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data/titanic-survival.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">(1309, 14)</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1304</th>
      <td>3</td>
      <td>0</td>
      <td>Zabour, Miss. Hileni</td>
      <td>female</td>
      <td>14.5</td>
      <td>1</td>
      <td>0</td>
      <td>2665</td>
      <td>14.4542</td>
      <td>NaN</td>
      <td>C</td>
      <td>NaN</td>
      <td>328.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1305</th>
      <td>3</td>
      <td>0</td>
      <td>Zabour, Miss. Thamine</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>0</td>
      <td>2665</td>
      <td>14.4542</td>
      <td>NaN</td>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1306</th>
      <td>3</td>
      <td>0</td>
      <td>Zakarian, Mr. Mapriededer</td>
      <td>male</td>
      <td>26.5</td>
      <td>0</td>
      <td>0</td>
      <td>2656</td>
      <td>7.2250</td>
      <td>NaN</td>
      <td>C</td>
      <td>NaN</td>
      <td>304.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1307</th>
      <td>3</td>
      <td>0</td>
      <td>Zakarian, Mr. Ortin</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>2670</td>
      <td>7.2250</td>
      <td>NaN</td>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1308</th>
      <td>3</td>
      <td>0</td>
      <td>Zimmerman, Mr. Leo</td>
      <td>male</td>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>315082</td>
      <td>7.8750</td>
      <td>NaN</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>Cette base contient 1309 observations (ici des passagers) et 14 variables qui permet de les caractériser. Voyons comment sélectionner des sous-ensembles de ces données.  </p>
<h2 id="filtrer-des-observations">Filtrer des observations</h2>
<p>On s'intéresse tout d'abord à la sélection sur les lignes. Différentes options sont possibles :  </p>
<h3 id="a-partir-de-leur-position-avec-iloc">À partir de leur position  avec <code>iloc</code></h3>
<p>Dans <code>pandas</code>, il est possible de sélectionner certaines lignes directement en renseignant leur position avec la syntaxe <code>data_frame.iloc[positions_lignes, positions_colonnes]</code>. En ayant bien en tête qu'en Python, la première observation correspond à la position 0, on peut par exemple sélectionner les lignes 1 à 3 :   </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span> 
<span class="c1"># &quot;0:3&quot; lignes de la position 0 à la position 3 exclue</span>
<span class="c1"># &quot;:&quot; pour sélectionner l&#39;ensemble des colonnes</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Allen, Miss. Elisabeth Walton</td>
      <td>female</td>
      <td>29.0000</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Allison, Master. Hudson Trevor</td>
      <td>male</td>
      <td>0.9167</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>11</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Miss. Helen Loraine</td>
      <td>female</td>
      <td>2.0000</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
  </tbody>
</table>
</div>

<p>On note que l'écriture <code>a:b</code> sélectionne les lignes de la position <code>a inclue</code> à la position <code>b exclue</code>. Les index négatifs partent de la fin de la base, ainsi l'index <code>-1</code> correspond à la dernière observation. Il est possible aussi de renseigner les positions souhaitées dans une liste, ou de faire des combinaisons plus complexes en utilisant <code>range</code> et la concaténation de listes avec <code>+</code>, ci-dessous les lignes 1 à 2, 10 à 12 et l'avant-dernière à la dernière  :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">:]</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Allen, Miss. Elisabeth Walton</td>
      <td>female</td>
      <td>29.0000</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Allison, Master. Hudson Trevor</td>
      <td>male</td>
      <td>0.9167</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>11</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>0</td>
      <td>Artagaveytia, Mr. Ramon</td>
      <td>male</td>
      <td>71.0000</td>
      <td>0</td>
      <td>0</td>
      <td>PC 17609</td>
      <td>49.5042</td>
      <td>NaN</td>
      <td>C</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>Montevideo, Uruguay</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>0</td>
      <td>Astor, Col. John Jacob</td>
      <td>male</td>
      <td>47.0000</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17757</td>
      <td>227.5250</td>
      <td>C62 C64</td>
      <td>C</td>
      <td>NaN</td>
      <td>124.0</td>
      <td>New York, NY</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1</td>
      <td>1</td>
      <td>Astor, Mrs. John Jacob (Madeleine Talmadge Force)</td>
      <td>female</td>
      <td>18.0000</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17757</td>
      <td>227.5250</td>
      <td>C62 C64</td>
      <td>C</td>
      <td>4</td>
      <td>NaN</td>
      <td>New York, NY</td>
    </tr>
    <tr>
      <th>1307</th>
      <td>3</td>
      <td>0</td>
      <td>Zakarian, Mr. Ortin</td>
      <td>male</td>
      <td>27.0000</td>
      <td>0</td>
      <td>0</td>
      <td>2670</td>
      <td>7.2250</td>
      <td>NaN</td>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1308</th>
      <td>3</td>
      <td>0</td>
      <td>Zimmerman, Mr. Leo</td>
      <td>male</td>
      <td>29.0000</td>
      <td>0</td>
      <td>0</td>
      <td>315082</td>
      <td>7.8750</td>
      <td>NaN</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>Vous aurez peut-être remarqué qu'il est aussi possible de filtrer sur les observations avec <code>.loc</code> en renseignant leur position. C'est en fait dû au fait que par défaut, l'index des lignes correspond à leur position. Mais si vous voulez filtrer en fonction de la <strong>position</strong> des lignes, il est préférable d'utiliser <code>iloc</code>. À noter aussi que la syntaxe <code>a:b</code> dans le cas où vous utilisez <code>.loc</code> <strong>inclue l'élément à la position <code>b</code></strong> : </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Allen, Miss. Elisabeth Walton</td>
      <td>female</td>
      <td>29.0000</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Allison, Master. Hudson Trevor</td>
      <td>male</td>
      <td>0.9167</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>11</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Miss. Helen Loraine</td>
      <td>female</td>
      <td>2.0000</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Mr. Hudson Joshua Creighton</td>
      <td>male</td>
      <td>30.0000</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>135.0</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
  </tbody>
</table>
</div>

<p>Si le dataframe avait eu un autre index que celui de la position par défaut, cette syntaxe n'aurait fonctionné qu'avec <code>iloc</code>:  </p>
<div class="highlight"><pre><span></span><code><span class="c1"># on crée un index correspondant au nom des passagers</span>
<span class="n">titanic_index_name</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>

<span class="c1"># titanic_index_name.loc[0:3, :] renvoie une erreur</span>
<span class="n">titanic_index_name</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">]</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Allen, Miss. Elisabeth Walton</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>29.0000</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>Allison, Master. Hudson Trevor</th>
      <td>1</td>
      <td>1</td>
      <td>male</td>
      <td>0.9167</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>11</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>Allison, Miss. Helen Loraine</th>
      <td>1</td>
      <td>0</td>
      <td>female</td>
      <td>2.0000</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="a-partir-de-leur-index-avec-loc">À partir de leur index avec <code>loc</code></h3>
<p>Cette dernière remarque nous amène tout naturellement vers la seconde manière de filtrer les observations : à partir de leur index. En effet, il est possible avec <code>pandas</code> de créer un index qui permet de sélectionner des lignes en fonction de leur label. Ici nous avons créé le dataframe <code>titanic_index_name</code> qui identifie chaque ligne avec le nom du passager à laquelle elle correspond. On peut alors sélectionner une ou plusieurs lignes en utilisant ces labels, que l'on renseigne dans une liste :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic_index_name</span><span class="o">.</span><span class="n">index</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">Index([&#39;Allen, Miss. Elisabeth Walton&#39;, &#39;Allison, Master. Hudson Trevor&#39;,</span>
<span class="err">       &#39;Allison, Miss. Helen Loraine&#39;, &#39;Allison, Mr. Hudson Joshua Creighton&#39;,</span>
<span class="err">       &#39;Allison, Mrs. Hudson J C (Bessie Waldo Daniels)&#39;,</span>
<span class="err">       &#39;Anderson, Mr. Harry&#39;, &#39;Andrews, Miss. Kornelia Theodosia&#39;,</span>
<span class="err">       &#39;Andrews, Mr. Thomas Jr&#39;,</span>
<span class="err">       &#39;Appleton, Mrs. Edward Dale (Charlotte Lamson)&#39;,</span>
<span class="err">       &#39;Artagaveytia, Mr. Ramon&#39;,</span>
<span class="err">       ...</span>
<span class="err">       &#39;Yasbeck, Mr. Antoni&#39;, &#39;Yasbeck, Mrs. Antoni (Selini Alexander)&#39;,</span>
<span class="err">       &#39;Youseff, Mr. Gerious&#39;, &#39;Yousif, Mr. Wazli&#39;, &#39;Yousseff, Mr. Gerious&#39;,</span>
<span class="err">       &#39;Zabour, Miss. Hileni&#39;, &#39;Zabour, Miss. Thamine&#39;,</span>
<span class="err">       &#39;Zakarian, Mr. Mapriededer&#39;, &#39;Zakarian, Mr. Ortin&#39;,</span>
<span class="err">       &#39;Zimmerman, Mr. Leo&#39;],</span>
<span class="err">      dtype=&#39;object&#39;, name=&#39;name&#39;, length=1309)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># Une ligne : </span>
<span class="n">titanic_index_name</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Allen, Miss. Elisabeth Walton&quot;</span><span class="p">,</span> <span class="p">:]</span>

<span class="c1"># Plusieurs lignes :  les index de la famille Allen</span>
<span class="n">liste_allen</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">titanic_index_name</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Allen&quot;</span><span class="p">)]</span>
<span class="n">titanic_index_name</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">liste_allen</span><span class="p">,</span> <span class="p">:]</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Allen, Miss. Elisabeth Walton</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>Allen, Mr. William Henry</th>
      <td>3</td>
      <td>0</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Lower Clapton, Middlesex or Erdington, Birmingham</td>
    </tr>
  </tbody>
</table>
</div>

<p>À noter que si vous sélectionnez une seule ligne, renseigner le label correspondant directement dans une chaîne de caractères vous renverra une <code>Serie</code>, soit un vecteur de valeurs pour <code>pandas</code> alors que le renseigner dans une liste vous renverra un <code>DataFrame</code> avec une seule ligne :  </p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">titanic_index_name</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Allen, Miss. Elisabeth Walton&quot;</span><span class="p">,</span> <span class="p">:]),</span>
      <span class="nb">type</span><span class="p">(</span><span class="n">titanic_index_name</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;Allen, Miss. Elisabeth Walton&quot;</span><span class="p">],</span> <span class="p">:]))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">&lt;class &#39;pandas.core.series.Series&#39;&gt; &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
</code></pre></div>

<h3 id="a-partir-de-conditions-avec-loc-et">À partir de conditions avec <code>loc</code> et <code>[]</code></h3>
<p>Enfin, et c'est sans doute le cas qui est le plus utilisé dans la pratique, on peut filtrer sur les observations à partir d'une condition. L'idée est de garder seulement les lignes correspondant à la condition. <br>
Imaginons par exemple qu'on veuille le tableau contenant uniquement les passagères. La condition <code>titanic.sex == "female"</code> va renvoyer un vecteur de booléens de la taille du nombre de lignes de <code>titanic</code> renseignant <code>True</code> ou <code>False</code> en fonction de si la ligne correspond à un passager ou une passagère :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s2">&quot;female&quot;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">0        True</span>
<span class="err">1       False</span>
<span class="err">2        True</span>
<span class="err">3       False</span>
<span class="err">4        True</span>
<span class="err">        ...  </span>
<span class="err">1304     True</span>
<span class="err">1305     True</span>
<span class="err">1306    False</span>
<span class="err">1307    False</span>
<span class="err">1308    False</span>
<span class="c">Name: sex, Length: 1309, dtype: bool</span>
</code></pre></div>

<p>On peut utiliser cette condition pour sélectionner un sous-ensemble du dataframe original avec <code>.loc</code> ou directement avec la syntaxe <code>data[condition]</code>.<br>
<strong>Attention :</strong> Si vous souhaitez créer un nouveau dataframe correspondant à ce sous-ensemble, pensez à utiliser la méthode <code>.copy()</code>, sinon vous aurez le warning <em>SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame</em> lorsque vous modifierez ce nouveau dataframe. C'est dû au fait que ces modifications affectent également le dataframe original si une copie n'a pas été créée.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># avec .loc</span>
<span class="n">titanic_femmes_loc</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># avec []</span>
<span class="n">titanic_femmes_croch</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s2">&quot;female&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># On teste qu&#39;on a bien le même dataframe et on affiche les 1eres lignes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">titanic_femmes_loc</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">titanic_femmes_croch</span><span class="p">))</span>
<span class="n">titanic_femmes_loc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">True</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Allen, Miss. Elisabeth Walton</td>
      <td>female</td>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Miss. Helen Loraine</td>
      <td>female</td>
      <td>2.0</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Mrs. Hudson J C (Bessie Waldo Daniels)</td>
      <td>female</td>
      <td>25.0</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>1</td>
      <td>Andrews, Miss. Kornelia Theodosia</td>
      <td>female</td>
      <td>63.0</td>
      <td>1</td>
      <td>0</td>
      <td>13502</td>
      <td>77.9583</td>
      <td>D7</td>
      <td>S</td>
      <td>10</td>
      <td>NaN</td>
      <td>Hudson, NY</td>
    </tr>
  </tbody>
</table>
</div>

<p>Il est bien sûr possible de faire des conditions plus complexes avec les opérateurs <code>&amp;</code> (opérateur logique "ET") et <code>|</code> (opérateur logique "OU"), par exemple les femmes de plus de 60 ans :  </p>
<div class="highlight"><pre><span></span><code><span class="n">my_cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s2">&quot;female&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">my_cond</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>1</td>
      <td>Andrews, Miss. Kornelia Theodosia</td>
      <td>female</td>
      <td>63.0</td>
      <td>1</td>
      <td>0</td>
      <td>13502</td>
      <td>77.9583</td>
      <td>D7</td>
      <td>S</td>
      <td>10</td>
      <td>NaN</td>
      <td>Hudson, NY</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1</td>
      <td>1</td>
      <td>Bucknell, Mrs. William Robert (Emma Eliza Ward)</td>
      <td>female</td>
      <td>60.0</td>
      <td>0</td>
      <td>0</td>
      <td>11813</td>
      <td>76.2917</td>
      <td>D15</td>
      <td>C</td>
      <td>8</td>
      <td>NaN</td>
      <td>Philadelphia, PA</td>
    </tr>
    <tr>
      <th>61</th>
      <td>1</td>
      <td>1</td>
      <td>Cavendish, Mrs. Tyrell William (Julia Florence...</td>
      <td>female</td>
      <td>76.0</td>
      <td>1</td>
      <td>0</td>
      <td>19877</td>
      <td>78.8500</td>
      <td>C46</td>
      <td>S</td>
      <td>6</td>
      <td>NaN</td>
      <td>Little Onn Hall, Staffs</td>
    </tr>
    <tr>
      <th>78</th>
      <td>1</td>
      <td>1</td>
      <td>Compton, Mrs. Alexander Taylor (Mary Eliza Ing...</td>
      <td>female</td>
      <td>64.0</td>
      <td>0</td>
      <td>2</td>
      <td>PC 17756</td>
      <td>83.1583</td>
      <td>E45</td>
      <td>C</td>
      <td>14</td>
      <td>NaN</td>
      <td>Lakewood, NJ</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="selectionner-des-variables">Sélectionner des variables</h2>
<h3 id="a-partir-de-leur-position-avec-iloc_1">À partir de leur position avec <code>iloc</code></h3>
<p>De manière complètement analogue à ce que l'on faisait avec les lignes, il est possible de sélectionner certaines variables en indiquant dans <code>iloc</code> une liste de positions, par exemple pour sélectionner la première et la dernière colonne :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
  </tbody>
</table>
</div>

<p>À noter que cette notation ne fonctionnera pas ni avec <code>.loc</code>, ni avec <code>[]</code>, qui ont besoin des labels des variables.  </p>
<h3 id="a-partir-de-leur-nom-avec-loc-et">À partir de leur nom avec <code>loc</code> et <code>[]</code></h3>
<p>Tout comme on pouvait filtrer les lignes à partir de leur label quand on définissait un index, il est possible de sélectionner certaines variables en les renseignant dans une liste avec <code>.loc</code> et <code>[]</code> :  </p>
<div class="highlight"><pre><span></span><code><span class="c1"># avec .loc</span>
<span class="n">titanic_select_loc</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;pclass&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># avec []</span>
<span class="n">titanic_select_croch</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[[</span><span class="s2">&quot;pclass&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">titanic_select_loc</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">titanic_select_croch</span><span class="p">))</span>
<span class="n">titanic_select_loc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">True</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>female</td>
      <td>29.0000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>male</td>
      <td>0.9167</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>female</td>
      <td>2.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>male</td>
      <td>30.0000</td>
    </tr>
  </tbody>
</table>
</div>

<p>Notons qu'avec <code>loc</code> on peut également utiliser la syntaxe <code>"label1" : "labeln"</code> pour sélectionner toutes les colonnes se situant entre deux colonnes inclues :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;pclass&quot;</span><span class="p">:</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Allen, Miss. Elisabeth Walton</td>
      <td>female</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Allison, Master. Hudson Trevor</td>
      <td>male</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Miss. Helen Loraine</td>
      <td>female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Mr. Hudson Joshua Creighton</td>
      <td>male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Mrs. Hudson J C (Bessie Waldo Daniels)</td>
      <td>female</td>
    </tr>
  </tbody>
</table>
</div>

<p>Enfin, de la même manière qu'avec les lignes, sélectionner une seule colonne en renseignant son label directement ou dans une liste renverra une <code>Serie</code> ou un <code>DataFrame</code> :  </p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;pclass&quot;</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;pclass&quot;</span><span class="p">]]))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">&lt;class &#39;pandas.core.series.Series&#39;&gt; &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
</code></pre></div>

<h3 id="a-partir-de-conditions-avec-loc">À partir de conditions avec <code>loc</code></h3>
<p>Enfin, il est possible de sélectionner certaines colonnes en fonction de conditions, représentées par un vecteur de booléens. En général, on va créer ce vecteur en s'appuyant sur les méthodes <code>pandas</code> permettant de caractériser les colonnes de notre dataframe, comme <code>.columns</code> et <code>.dtypes</code> :   </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">titanic</span><span class="o">.</span><span class="n">dtypes</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">(Index([&#39;pclass&#39;, &#39;survived&#39;, &#39;name&#39;, &#39;sex&#39;, &#39;age&#39;, &#39;sibsp&#39;, &#39;parch&#39;, &#39;ticket&#39;,</span>
<span class="err">        &#39;fare&#39;, &#39;cabin&#39;, &#39;embarked&#39;, &#39;boat&#39;, &#39;body&#39;, &#39;home.dest&#39;],</span>
<span class="err">       dtype=&#39;object&#39;),</span>
<span class="err"> pclass         int64</span>
<span class="err"> survived       int64</span>
<span class="err"> name          object</span>
<span class="err"> sex           object</span>
<span class="err"> age          float64</span>
<span class="err"> sibsp          int64</span>
<span class="err"> parch          int64</span>
<span class="err"> ticket        object</span>
<span class="err"> fare         float64</span>
<span class="err"> cabin         object</span>
<span class="err"> embarked      object</span>
<span class="err"> boat          object</span>
<span class="err"> body         float64</span>
<span class="err"> home.dest     object</span>
<span class="err"> dtype: object)</span>
</code></pre></div>

<p>On peut par exemple sélectionner les variables renseignant des entiers (<code>cond1</code>), ou celles commençant par la lettre b :  </p>
<div class="highlight"><pre><span></span><code><span class="n">cond1</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">cond1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>sibsp</th>
      <th>parch</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><code><span class="n">cond2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">titanic</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)]</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">cond2</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>sex</th>
      <th>sibsp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>female</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>male</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>female</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>male</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>female</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="synthese-jutilise-quoi-du-coup">Synthèse : j'utilise quoi du coup?</h2>
<h3 id="iloc-ou-loc"><code>iloc</code> ou <code>loc</code> ?</h3>
<p>En résumé, les syntaxes <code>data.iloc[i, j]</code> et <code>data.loc[i, j]</code> suivent la même logique en permettant dans le même appel de filtrer sur les lignes en i et sur les colonnes en j. Le choix entre <code>iloc</code> et <code>loc</code> est seulement guidé par le fait que votre sélection porte sur :  </p>
<ul>
<li>les <strong>positions des lignes ou des colonnes</strong>. Dans ce cas vous devez utiliser <code>iloc</code>.  </li>
<li>les <strong>noms des colonnes, les index des lignes, ou un vecteur de booléens</strong>. Dans ce cas utilisez <code>loc</code>.  </li>
</ul>
<p>Rappelez vous que sélectionner par les positions avec <code>.loc</code> n'est possible que quand les index par défaut sont les positions des lignes. Mais cela porte à confusion. Prenons par exemple notre table triée par âge pour laquelle on n'a pas réinitialisé les index :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic_sorted</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">titanic_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>763</th>
      <td>3</td>
      <td>1</td>
      <td>Dean, Miss. Elizabeth Gladys "Millvina"</td>
      <td>female</td>
      <td>0.1667</td>
      <td>1</td>
      <td>2</td>
      <td>C.A. 2315</td>
      <td>20.5750</td>
      <td>NaN</td>
      <td>S</td>
      <td>10</td>
      <td>NaN</td>
      <td>Devon, England Wichita, KS</td>
    </tr>
    <tr>
      <th>747</th>
      <td>3</td>
      <td>0</td>
      <td>Danbom, Master. Gilbert Sigvard Emanuel</td>
      <td>male</td>
      <td>0.3333</td>
      <td>0</td>
      <td>2</td>
      <td>347080</td>
      <td>14.4000</td>
      <td>NaN</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Stanton, IA</td>
    </tr>
    <tr>
      <th>1240</th>
      <td>3</td>
      <td>1</td>
      <td>Thomas, Master. Assad Alexander</td>
      <td>male</td>
      <td>0.4167</td>
      <td>0</td>
      <td>1</td>
      <td>2625</td>
      <td>8.5167</td>
      <td>NaN</td>
      <td>C</td>
      <td>16</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>427</th>
      <td>2</td>
      <td>1</td>
      <td>Hamalainen, Master. Viljo</td>
      <td>male</td>
      <td>0.6667</td>
      <td>1</td>
      <td>1</td>
      <td>250649</td>
      <td>14.5000</td>
      <td>NaN</td>
      <td>S</td>
      <td>4</td>
      <td>NaN</td>
      <td>Detroit, MI</td>
    </tr>
    <tr>
      <th>1111</th>
      <td>3</td>
      <td>0</td>
      <td>Peacock, Master. Alfred Edward</td>
      <td>male</td>
      <td>0.7500</td>
      <td>1</td>
      <td>1</td>
      <td>SOTON/O.Q. 3101315</td>
      <td>13.7750</td>
      <td>NaN</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>Si l'on veut la première et la 5e ligne de ce nouveau dataframe, il faut bien utiliser <code>iloc</code> et non <code>loc</code> qui renverra les index 0 et 5 de l'ancien dataframe <code>titanic</code> :  </p>
<div class="highlight"><pre><span></span><code><span class="n">titanic_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">:]</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>763</th>
      <td>3</td>
      <td>1</td>
      <td>Dean, Miss. Elizabeth Gladys "Millvina"</td>
      <td>female</td>
      <td>0.1667</td>
      <td>1</td>
      <td>2</td>
      <td>C.A. 2315</td>
      <td>20.575</td>
      <td>NaN</td>
      <td>S</td>
      <td>10</td>
      <td>NaN</td>
      <td>Devon, England Wichita, KS</td>
    </tr>
    <tr>
      <th>1111</th>
      <td>3</td>
      <td>0</td>
      <td>Peacock, Master. Alfred Edward</td>
      <td>male</td>
      <td>0.7500</td>
      <td>1</td>
      <td>1</td>
      <td>SOTON/O.Q. 3101315</td>
      <td>13.775</td>
      <td>NaN</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><code><span class="n">titanic_sorted</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">:]</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pclass</th>
      <th>survived</th>
      <th>name</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>ticket</th>
      <th>fare</th>
      <th>cabin</th>
      <th>embarked</th>
      <th>boat</th>
      <th>body</th>
      <th>home.dest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Allen, Miss. Elisabeth Walton</td>
      <td>female</td>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>24160</td>
      <td>211.3375</td>
      <td>B5</td>
      <td>S</td>
      <td>2</td>
      <td>NaN</td>
      <td>St Louis, MO</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>Allison, Mrs. Hudson J C (Bessie Waldo Daniels)</td>
      <td>female</td>
      <td>25.0</td>
      <td>1</td>
      <td>2</td>
      <td>113781</td>
      <td>151.5500</td>
      <td>C22 C26</td>
      <td>S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Montreal, PQ / Chesterville, ON</td>
    </tr>
  </tbody>
</table>
</div>

<p>On aurait aussi pu utiliser le paramètre <code>ignore_index</code> dans <code>sort_values()</code> pour réinitialiser directement les index.  </p>
<h3 id="ou-loc"><code>[]</code> ou <code>loc</code>?</h3>
<p>Les crochets n'explicitent pas autant s'ils sélectionnent sur des lignes ou des colonnes. Si vous renseignez une liste de labels ils vont sélectionner des colonnes, et si vous renseignez une liste de booléens ils vont filtrer sur les lignes. Il est possible de chaîner les opérations sur les lignes ou les colonnes. Ainsi : <code>titanic[titanic.sex == "female"]["name"]</code> donnera le même résultat que <code>titanic.loc[titanic.sex == "female", "name"]</code>, c'est à dire les noms (colonne "name") des passagères (lignes correspondant aux femmes). 
Il vous revient donc de choisir ce qui vous convient le mieux. Dans le cas où on sélectionne à la fois sur les lignes et les colonnes, la syntaxe de <code>loc</code> a l'avantage d'être plus lisible. Dans le cas où on sélectionne seulement des colonnes ou seulement des lignes, l'usage des crochets permettra de taper les instructions légèrement plus rapidement. Enfin quand on veut extraire une série d'un dataframe, on utilisera avantageusement la syntaxe <code>data.nom_col</code>, équivalente à <code>data["nom_col"]</code>.  </p>
<p>C'est la fin de cet article! N'hésitez pas à <a href="https://www.statoscop.fr">visiter notre site</a> et à nous suivre sur <a href="https://twitter.com/stato_scop">Twitter</a> et <a href="https://www.linkedin.com/company/statoscop">Linkedin</a>. Pour retrouver l'ensemble du code ayant servi à générer cette note, vous pouvez vous rendre sur le <a href="https://github.com/Statoscop/notebooks-blog">github de Statoscop</a>.  </p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Manipulation de données avec pandas&amp;url=https://blog.statoscop.fr/manip-donnees-pandas.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://blog.statoscop.fr/tag/python.html">Python</a><a href="https://blog.statoscop.fr/tag/statistiques.html">Statistiques</a><a href="https://blog.statoscop.fr/tag/data-science.html">Data Science</a><a href="https://blog.statoscop.fr/tag/index.html">index</a><a href="https://blog.statoscop.fr/tag/loc.html">loc</a><a href="https://blog.statoscop.fr/tag/iloc.html">iloc</a><a href="https://blog.statoscop.fr/tag/colonnes.html">colonnes</a><a href="https://blog.statoscop.fr/tag/lignes.html">lignes</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
          <span class="credits-theme">Blog réalisé par les fondateurs de Statoscop et publié avec
            <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a>
          </span>
          <span class="credits-software">
            Thème <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a>
          </span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://blog.statoscop.fr/themes/statoscop/static/js/script.js"></script>

</body>
</html>